String.prototype.hasString=function(a){if("object"==typeof a){for(var b=0,c=a.length;b<c;b++)if(!this.hasString(a[b]))return!1;return!0}if(-1!=this.indexOf(a))return!0};String.prototype.breakWord=function(a,b){b||(b="<wbr/>");return this.replace(RegExp("(\\w{"+(a?a:0)+"})(\\w)","g"),function(a,e,f){return e+b+f})};window.UI&&function(){var a=UI;window.UI_=function(){for(var b in a)UI[b]||(UI[b]=a[b])}}();UI={ajax:function(a){var b=a.xhr||UI.xmlHttp(),c,e;a.async=UI.isUndefined(a.async)?!0:a.async;b.onreadystatechange=function(){b&&(1==b.readyState?a.timeout&&a.fail&&(e=setTimeout(function(){c||(c=1,a.fail(),b.abort(),b=null)},a.timeout),a.timeout=0):2==b.readyState?a.send&&a.send():4==b.readyState&&!c&&(c=1,200==b.status?a.success&&a.success(b.responseText):a.fail&&a.fail(),clearTimeout(e),b=null))};if(UI.isObject(a.data)){var f=[],g;for(g in a.data)f.push(g+"="+encodeURIComponent(a.data[g]));a.data=f.join("&")}f=function(){a.refer&&b.setRequestHeader("rf",a.refer)};"get"==a.type?(b.open("GET",a.url+(a.url.hasString("?")?"&":"?")+(a.data||""),a.async),f(),b.send(null)):(b.open("POST",a.url,a.async),f(),b.setRequestHeader("Content-type","application/x-www-form-urlencoded"),b.send(a.data));return b},get:function(a,b,c){var e=UI.xmlHttp(),f=a.hasString("?")?"&":"?";e.onreadystatechange=function(){if(4==e.readyState&&200==e.status)try{c(e.responseText)}catch(a){}else return e};if(void 0!=b)if(UI.isObject(b)){var g=[],h;for(h in b)g.push(h+"="+encodeURIComponent(b[h]));a+=f+g.join("&")}else a+=f+b;e.open("GET",a,!0);e.send(null);return e},xmlHttp:function(){return window.ActiveXObject?function(){return new ActiveXObject("Microsoft.XMLHTTP")}:window.XMLHttpRequest?function(){return new XMLHttpRequest}:function(){}}(),crossAsynJson:function(a,b,c,e){var f=UI.DC("script"),g=UI.GT(document,"head")[0];window[b]=function(a){window[b]=void 0;try{delete window[b]}catch(i){}c(a);g&&setTimeout(function(){g.removeChild(f)},5)};e&&UI.A(f,"charset",e);UI.A(f,"type","text/javascript");UI.A(f,"src",a);g.appendChild(f)},getScript:function(a,b,c){var e=UI.DC("script");UI.B.ie?e.onreadystatechange=function(){if("loaded"==this.readyState||"complete"==this.readyState)b&&b(),e=null}:e.onload=function(){b&&b();e=null};c&&UI.A(e,"charset",c);UI.A(e,"type","text/javascript");UI.A(e,"src",a);UI.A(e,"async","true");UI.GT(document,"head")[0].appendChild(e)},getCss:function(){function a(){try{for(var b=document.styleSheets,c,e,f=0,g=b.length;f<g;f++)if(e=b[f].ownerNode,e.href==url)if(UI.B.safari)c=e.sheet;else if(e.sheet)try{c=e.sheet.cssRules}catch(h){1E3==h.code&&(c=1)}c?call():setTimeout(a,50)}catch(i){setTimeout(a,50)}}return function(b,c,e){var f=e?e:UI.DC("link");c&&(UI.B.safari||UI.B.firefox?setTimeout(a,50):f.onload=function(){c()});e||(UI.A(f,"rel","stylesheet"),UI.A(f,"type","text/css"),UI.GT(document,"head")[0].appendChild(f));UI.A(f,"href",b)}}(),evalScript:function(a){var b=this.regExp.script;(a=(a||"").match(RegExp(b,"img")))&&UI.each(a,function(a){eval(a.match(RegExp(b,"im"))[1])})},regExp:{script:"<script[^>]*>([\\S\\s]*?)<\/script>"},encode:function(a){return escape(UI.utfEncode(a))},decode:function(a){return UI.utfDecode(unescape(a))},utfEncode:function(a){for(var a=a.replace(/\r\n/g,"\n"),b="",c=0,e=a.length;c<e;c++){var f=a.charCodeAt(c);128>f?b+=String.fromCharCode(f):(127<f&&2048>f?b+=String.fromCharCode(f>>6|192):(b+=String.fromCharCode(f>>12|224),b+=String.fromCharCode(f>>6&63|128)),b+=String.fromCharCode(f&63|128))}return b},utfDecode:function(a){for(var b="",c=0,e=c1=c2=c3=0;c<a.length;)e=a.charCodeAt(c),128>e?(b+=String.fromCharCode(e),c++):191<e&&224>e?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((e&31)<<6|c2&63),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((e&15)<<12|(c2&63)<<6|c3&63),c+=3);return b},parseUrl:function(a,b){var c=a?a:document.location.href,e={},b=b||"?";if(!c.hasString(b))return e;for(var c=c.split(b)[1].split("&"),f=0;f<c.length;f++){var g=c[f].replace(/#.*$/g,"").split("=");g[1]||(g[1]="");e[g[0]]=UI.B.ie?g[1]:UI.decode(g[1])}return e},cookie:function(a,b,c,e){if(void 0==b){a+="=";b=document.cookie.split(";");c=0;for(e=b.length;c<e;c++){for(var f=b[c];" "==f.charAt(0);)f=f.substring(1,f.length);if(0==f.indexOf(a))return decodeURIComponent(f.substring(a.length,f.length))}return null}f="";c&&(f=new Date,f.setTime(f.getTime()+864E5*c),f="; expires="+f.toGMTString());document.cookie=a+"="+b+f+"; path=/"+(e?";domain="+e:"")},drag:function(a,b,c){var e=document,c=void 0!=c?c:!0;UI.EA(a,"mousedown",function(f){b.start&&b.start(f);c&&(a.setCapture?a.setCapture():window.captureEvents&&window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP));b.drag&&(e.onmousemove=b.drag);e.onmouseup=function(){c&&(a.releaseCapture?a.releaseCapture():window.releaseEvents&&window.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP));b.stop&&b.stop(f);e.onmousemove=null;e.onmouseup=null;b.call&&b.call(f)}})},animate:function(a,b,c,e,f,g){var f=f||0.4,h=b.hasString("scroll"),i="height,width,marginLeft,marginTop".hasString(b),k,j=setInterval(function(){var n,m,g,p="opacity"==b;n=i?a.style[b]:h?a[b]:UI.C(a,b);p?(n*=100,c*=100,100<c&&(c=100)):h||(n="auto"==n?0:Number(n.slice(0,-2)));if(isNaN(c))clearInterval(j);else{if(3>=Math.abs(c-n)||h&&k==n)n=c,clearInterval(j);g=(c-n)*f;p||(0<g&&1>g?g=1:0>g&&-1<g&&(g=-1));m=k=n+g;if(!p&&(0>g&&0<c-m||0<g&&0<m-c))m=c;i?a.style[b]=m+"px":h?a[b]=parseInt(m):UI.C(a,b,!p?m+"px":m/100+"");n==c&&(UI.isString(e)?eval(e):e&&e())}},g||40);return j},getX:function(a){return a.getBoundingClientRect?a.getBoundingClientRect().left+UI.scrollX():(a.offsetParent?a.offsetLeft+UI.getX(a.offsetParent):a.offsetLeft)+("fixed"==UI.C(a,"position")?UI.scrollX():0)},getY:function(a){return a.getBoundingClientRect?a.getBoundingClientRect().top+UI.scrollY():(a.offsetParent?a.offsetTop+UI.getY(a.offsetParent):a.offsetTop)+("fixed"==UI.C(a,"position")?UI.scrollY():0)},within:function(a,b){var c=UI.getX(b)-UI.scrollX(),e=UI.width(b)+c,f=UI.getY(b)-UI.scrollY(),g=UI.height(b)+f,h={};if(a[0]>c&&a[0]<e&&a[1]>f&&a[1]<g)return a[0]-c<(e-c)/2&&(h.left=!0),a[1]-f<(g-f)/2&&(h.top=!0),h},frameX:function(a){return a.frameElement?UI.getX(a.frameElement)+UI.frameX(a.parent):0},frameY:function(a){return a.frameElement?UI.getY(a.frameElement)+UI.frameY(a.parent):0},width:function(a){return a?parseInt(a.offsetWidth):0},height:function(a){return a?parseInt(a.offsetHeight):0},pageWidth:function(){return document.body.scrollWidth||document.documentElement.scrollWidth},pageHeight:function(){return document.body.scrollHeight||document.documentElement.scrollHeight},windowWidth:function(){var a=document.documentElement;return self.innerWidth||a&&a.clientWidth||document.body.clientWidth},windowHeight:function(){var a=document.documentElement;return self.innerHeight||a&&a.clientHeight||document.body.clientHeight},scrollX:function(a){var b=document.documentElement;if(a){var c=a.parentNode,e=a.scrollLeft||0;a==b&&(e=UI.scrollX());return c?e+UI.scrollX(c):e}return self.pageXOffset||b&&b.scrollLeft||document.body.scrollLeft},scrollY:function(a){var b=document.documentElement;if(a){var c=a.parentNode,e=a.scrollTop||0;a==b&&(e=UI.scrollY());return c?e+UI.scrollY(c):e}return self.pageYOffset||b&&b.scrollTop||document.body.scrollTop},scrollTo:function(a,b,c){if(a==document.documentElement||a==document.body)return window.scrollTo(b,c)},hide:function(a){UI.isString(a)&&(a=this.G(a));if(a){if(!a.__curDisplay){var b=this.C(a,"display");"none"!=b&&(a.__curDisplay=b)}a.style.display="none"}},show:function(a){UI.isString(a)&&(a=this.G(a));a&&(a.style.display=a.__curDisplay||"")},toggle:function(a){UI.isString(a)&&(a=this.G(a));"none"==this.C(a,"display")?this.show(a):this.hide(a)},hasClass:function(a,b){return!a||!a.className?!1:a.className!=a.className.replace(RegExp("\\b"+b+"\\b"),"")},addClass:function(a,b){a&&(a.className?this.hasClass(a,b)||(a.className+=" "+b):a.className=b)},removeClass:function(a,b){if(a){var c=b.split(" ");1<c.length?UI.each(c,function(b){UI.removeClass(a,b)}):this.hasClass(a,b)&&(a.className=a.className.replace(RegExp("\\b"+b+"\\b"),"").replace(/\s$/,""))}},toggleClass:function(a,b){this.hasClass(a,b)?this.removeClass(a,b):this.addClass(a,b)},next:function(a){a=a.nextSibling;return null==a?!1:UI.isElement(a)?a:this.next(a)},prev:function(a){a=a.previousSibling;return null==a?!1:UI.isElement(a)?a:this.prev(a)},remove:function(a){a&&a.parentNode&&a.parentNode.removeChild(a)},append:function(a,b){b.appendChild(a)},prepend:function(a,b){var c=b.firstChild;c?UI.before(a,c):UI.append(a,b)},after:function(a,b){var c=b.parentNode;c.lastChild==a?c.appendChild(a):c.insertBefore(a,b.nextSibling)},before:function(a,b){b.parentNode.insertBefore(a,b)},replace:function(a,b){b.parentNode.replaceChild(a,b)},tmpl:function(){var a={};return function c(e,f){var g=!/\W/.test(e)?a[e]=a[e]||c(UI.G(e).innerHTML):UI.tmplString(e);return f?g(f):g}}(),tmplString:function(a){return new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');")},txTpl:function(){var a={};return function(b,c,e,f,g){var h=[];if((g=void 0!=g?g:!0)&&a[b]){for(var g=0,i=a[b].propList,k=i.length;g<k;g++)h.push(c[i[g]]);c=a[b].parsefn}else{i=[];e||(e="<%");f||(f="%>");f=(-1==b.indexOf(e)?document.getElementById(b).innerHTML:b).replace(/\\/g,"\\\\").replace(/[\r\t\n]/g," ").split(e).join("\t").replace(RegExp("((^|"+f+")[^\t]*)'","g"),"$1\r").replace(RegExp("\t=(.*?)"+f,"g"),"';\n s+=$1;\n s+='").split("\t").join("';\n").split(f).join("\n s+='").split("\r").join("\\'");for(k in c)i.push(k),h.push(c[k]);c=new Function(i," var s='';\n s+='"+f+"';\n return s");g&&(a[b]={parsefn:c,propList:i})}try{return c.apply(null,h)}catch(j){b="txTpl"+(new Date).getTime(),c="var "+b+"="+c.toString(),g=navigator.userAgent.toLowerCase(),i=document.getElementsByTagName("head")[0],k=document.createElement("script"),-1<g.indexOf("gecko")&&-1==g.indexOf("khtml")?window.eval.call(window,c):(k.innerHTML=c,i.appendChild(k),i.removeChild(k)),window[b].apply(null,h)}}}(),html:function(a){var b=UI.DC("div"),c=[];b.innerHTML=a;UI.each(b.childNodes,function(a){UI.isElement(a)&&c.push(a)});return c},css:function(a,b){var c;b||(b=UI.DC("style"),UI.A(b,"type","text/css"),UI.append(b,UI.GT(document,"head")[0]));if(b.styleSheet)try{b.styleSheet.cssText=a}catch(e){c=$$("head style");var f=c.length;1<f&&(UI.remove(c[f-1]),c[f-2].styleSheet.cssText+=a)}else c=document.createTextNode(a),UI.append(c,b)},text:function(a){for(var b=[],a=a.childNodes,c,e=0,f=a.length;e<f;e++)c=a[e].nodeName.toUpperCase(),"STYLE"==c||"SCRIPT"==c||b.push(1!=a[e].nodeType?a[e].nodeValue:UI.text(a[e]));return b.join("")},parent:function(a,b){if(UI.isArray(a)){var c=[];UI.each(a,function(a){(b&&UI.hasClass(a.parentNode,b)||!b)&&c.push(a.parentNode)});return c}return a&&a.parentNode},parents:function(a,b){if(b){var c=[],e=UI.parents(a);UI.each(e,function(a){UI.hasClass(a,b)&&c.push(a)});return c}return(e=a.parentNode)?"HTML"==e.nodeName?[e]:[e].concat(UI.parents(e)):[]},children:function(a,b){var c=[];b&&(b=b.split("|"));UI.each(a.childNodes,function(a){var f=!1;if(b)for(var g=0,h=b.length;g<h;g++)if(UI.hasClass(a,b[g])){f=!0;break}UI.isElement(a)&&(!b||f)&&c.push(a)});return c},A:function(a,b,c){if(a&&a.getAttribute){if(void 0==c)return a.getAttribute(b)||"";""==c?a.removeAttribute(b):a.setAttribute(b,c)}},C:function(){var a;return function(b,c,e){if(b)if(void 0==e){if(window.getComputedStyle)return c=c.replace(/([A-Z])/g,"-$1"),c=c.toLowerCase(),window.getComputedStyle(b,null).getPropertyValue(c);if(b.currentStyle)return"opacity"==c?0<=b.style.filter.indexOf("opacity=")?parseFloat(b.style.filter.match(/opacity=([^)]*)/)[1])/100:"1":b.currentStyle[c]}else!a&&"opacity"==c&&(a="opacity"in b.style?1:2),"opacity"==c&&2==a?b.style.filter=(b.style.filter||"").replace(/alpha\([^)]*\)/,"")+"alpha(opacity="+100*e+")":b.style[c]=e}}(),DC:function(a){return document.createElement(a)},E:function(a){if(a&&a.clone)return a;a=window.event||a||{};return{clone:!0,stop:function(){a&&a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},prevent:function(){a&&a.preventDefault?a.preventDefault():a.returnValue=!1},target:a.target||a.srcElement,relatedTarget:a.relatedTarget||(a.fromElement&&a.fromElement===a.srcElement?a.toElement:a.fromElement),x:a.clientX||a.pageX,y:a.clientY||a.pageY,button:a.button,key:a.keyCode,shift:a.shiftKey,alt:a.altKey,ctrl:a.ctrlKey,type:a.type,wheel:a.wheelDelta/120||-a.detail/3}},bind:function(a,b,c){c&&UI.clear(function(){b=null});return function(){return a.apply(b,Array.prototype.slice.call(arguments))}},EA:function(a,b,c,e){if(a){if(UI.isString(a))var f=c,c=function(){eval(f)};return a.addEventListener?("mousewheel"==b&&UI.B.firefox&&(b="DOMMouseScroll"),a.addEventListener(b,c,e),!0):a.attachEvent?a.attachEvent("on"+b,c):!1}},ER:function(a,b,c){if(a)return a.removeEventListener?(a.removeEventListener(b,c,!1),!0):a.detachEvent?a.detachEvent("on"+b,c):!1},fireEvent:function(){return document.dispatchEvent?function(a,b){var c=document.createEvent("HTMLEvents");c.initEvent(b,!0,!0);return!a.dispatchEvent(c)}:function(a,b){var c=document.createEventObject();return a.fireEvent("on"+b,c)}}(),linkEvent:function(){var a={},b=function(b,e){var f=a[b];f&&UI.each(f,function(a){UI.isFunction(a)&&a(e)})};b.event=a;b.add=function(b,e){a[b]||(a[b]=[]);e&&a[b].push(e)};b.remove=function(b,e){var f=a[b];UI.each(f,function(a,b){e&&a==e&&f.splice(b,1)})};return b}(),proxyEvent:function(a,b,c,e){UI.EA(a,b,function(b){var g=UI.E(b),b=g.target,h=1,i=[],k=[];for(UI.proxyEventCache={};b;){h++;i.push(b);var j=b.className.split(" ").join(".");k.push(b.nodeName.toLowerCase()+(b.id?"#"+b.id:"")+(j?"."+j:""));UI.proxyEventStop||e&&h>=e||b===a?(b=null,UI.proxyEventStop=0):b=b.parentNode}UI.each(i,function(a,b){for(var h=0,e=c.length;h<e;h++){var j=c[h][1](a,k,i,b);j&&c[h][0].call(UI.isElement(j)?j:a,g)}})})},G:function(a){return UI.isElement(a)?a:document.getElementById(a)},GT:function(a,b){return a.getElementsByTagName(b)},GC:function(){function a(j,n){n||(n=j,j=document);j=j||document;if(!/^[\w\-_#]+$/.test(n)&&j.querySelectorAll)return b(j.querySelectorAll(n));if(-1<n.indexOf(",")){for(var m=n.split(/,/g),t=[],s=0,q=m.length;s<q;++s)t=t.concat(a(j,m[s]));return k(t)}var m=n.match(e),q=m.pop(),t=(q.match(g)||i)[1],v=!t&&(q.match(f)||i)[1],s=q.split(".").slice(2),q=!t&&(q.match(h)||i)[1];if(v&&!q&&j.getElementsByClassName)q=b(j.getElementsByClassName(v));else{q=!t&&b(j.getElementsByTagName(q||"*"));if(v){for(var v=RegExp("(^|\\s)"+v+"(\\s|$)"),u=-1,l,w=-1,x=[],s=s||"";l=q[++u];)v.test(l.className)&&l.className.hasString(s)&&(x[++w]=l);q=x}if(t)return(m=j.getElementById(t))?[m]:[]}return m[0]&&q[0]?c(m,q):q}function b(a){try{return Array.prototype.slice.call(a)}catch(b){for(var h=[],i=0,c=a.length;i<c;++i)h[i]=a[i];return h}}function c(a,b,j){var e=a.pop();if(">"===e)return c(a,b,!0);for(var k=[],n=-1,m=(e.match(g)||i)[1],u=!m&&(e.match(f)||i)[1],e=!m&&(e.match(h)||i)[1],l=-1,w,x,y,e=e&&e.toLowerCase();w=b[++l];){x=w.parentNode;do if(y=(y=(y=!e||"*"===e||e===x.nodeName.toLowerCase())&&(!m||x.id===m))&&(!u||RegExp("(^|\\s)"+u+"(\\s|$)").test(x.className)),j||y)break;while(x=x.parentNode);y&&(k[++n]=w)}return a[0]&&k[0]?c(a,k):k}var e=/(?:[\w\-\\.#]+)+(?:\[\w+?=([\'"])?(?:\\\1|.)+?\1\])?|\*|>/ig,f=/^(?:[\w\-_]+)?\.([\w\-_]+)/,g=/^(?:[\w\-_]+)?#([\w\-_]+)/,h=/^([\w\*\-_]+)/,i=[null,null],k,j=+new Date,n,m=1;n=function(a){var b=a[j],h=m++;return!b?(a[j]=h,!0):!1};k=function(a){for(var b=a.length,h=[],i=-1,c=0,e;c<b;++c)e=a[c],n(e)&&(h[++i]=e);j+=1;return h};return a}(),closest:function(a,b,c){c=c||document;for(b=UI.GC(c,b);a;){if(UI.has(b,a))return a;a=a.parentNode}return null},getEvent:function(){if(window.event)return window.event;for(var a=arguments.callee.caller;a;){var b=a.arguments[0];if(b&&(b.constructor===Event||b.constructor===MouseEvent||"object"===typeof b&&b.preventDefault&&b.stopPropagation))return b;a=a.caller}return null},sortElement:function(a,b){if(1<a.length&&b)for(var c=0,e=b.length;c<e;c++)a=a.sort(function(a,e){return a.className.hasString(b[c])&&!e.className.hasString(b[c])?1:-1});return a},withinElement:function(a,b){for(var b=UI.E(b||UI.getEvent()),c=b.relatedTarget||document;c;){if(a===c)return!0;c=c.parentNode}return!1},isDate:function(a){return"Date"==this.getType(a)},isMouseMove:function(){var a,b,c;UI.EA(document.body,"mousedown",function(a){a=UI.E(a);b=a.x+","+a.y});UI.EA(document.body,"mouseup",function(e){e=UI.E(e);c=e.x+","+e.y;a=b!=c});UI.isMouseMove=function(){return a}},cloneDate:function(a){if(!a)return a;d=new Date;d.setTime(a.getTime());return d},formatDate:function(a,b){for(var c=b.replace(/\W/g,",").split(","),e="yyyy MM dd hh mm ss ww".split(" "),f={y:a.getFullYear(),M:a.getMonth()+1,d:a.getDate(),h:a.getHours(),m:a.getMinutes(),s:a.getSeconds(),w:a.getDay()},g=0,h=c.length;g<h;g++)for(var i=c[g],k=0;7>k;k++){var j=e[k].slice(-1);i.hasString(j)&&("w"==j&&0==f[j]&&(f[j]=7),b=i.hasString(e[k])?b.replace(RegExp(e[k],"g"),this.addZero(f[j])):b.replace(RegExp(e[k].slice(e[k].length/2),"g"),f[j]))}return b},parseDate:function(a,b){b||(b="yyyy-MM-dd");var b=b.replace(/\W/g,",").split(","),a=a.replace(/\D/g,",").split(","),c=2E3,e=0,f=1,g=0,h=0,i=0;UI.each(b,function(b,j){""!=a[j]&&!isNaN(a[j])&&(b.hasString("y")&&(c=Number(a[j])),b.hasString("M")&&(e=Number(a[j])-1),b.hasString("d")&&(f=Number(a[j])),b.hasString("h")&&(g=Number(a[j])),b.hasString("m")&&(h=Number(a[j])),b.hasString("s")&&(i=Number(a[j])),b.hasString("w")&&(i=Number(a[j])))});return new Date(c,e,f,g,h,i)},zoneDate:function(a,b){var c=new Date(Number(a)),c=c.getTime()+6E4*c.getTimezoneOffset();return new Date(c+36E5*b)},isObject:function(a){return"object"==typeof a},isElement:function(a){return a&&1==a.nodeType},isUndefined:function(a){return"undefined"==typeof a},isFunction:function(a){return"Function"==this.getType(a)},isNumber:function(a){return"Number"==this.getType(a)},isString:function(a){return"String"==this.getType(a)},isArray:function(a){return"Array"==this.getType(a)},getType:function(a){return Object.prototype.toString.call(a).slice(8,-1)},json:function(a){var b={};if(a)try{b=eval("("+a+")")}catch(c){}return b},json2str:function(a){var b=[],c=UI.isArray(a);if(UI.isObject(a)){if(null===a)return"null";if(window.JSON&&window.JSON.stringify)return JSON.stringify(a);for(var e in a)b.push((c?"":'"'+e+'":')+UI.json2str(a[e]));b=b.join();return c?"["+b+"]":"{"+b+"}"}return UI.isNumber(a)||UI.isFunction(a)?a.toString():UI.isUndefined(a)?"undefined":!a?'""':'"'+a+'"'},addZero:function(a,b){return Array(Math.abs((""+a).length-((b||2)+1))).join(0)+a},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},random:function(a,b){void 0==a&&(a=0);void 0==b&&(b=9);return Math.floor(Math.random()*(b-a+1)+a)},has:function(a,b){for(var c=0,e=a.length;c<e;c++)if(a[c]==b)return!0;return!1},hasKey:function(a,b){return b in a},each:function(a,b){if(a)if(UI.isUndefined(a[0])&&!UI.isArray(a))for(var c in a){if(b(a[c],c))break}else{c=0;for(var e=a.length;c<e&&!b(a[c],c);c++);}},merge:function(a,b){var c=[];if(b)return UI.each(b,function(b){UI.has(a,b)||c.push(b)}),a.concat(c);UI.each(a,function(a){UI.has(c,a)||c.push(a)});return c},ready:function(a){if(UI.ready.done)return a();UI.isReady.done?UI.readyDo.push(a):(UI.readyDo=[a],UI.isReady())},readyDo:[],isReady:function(){if(!UI.isReady.done){UI.isReady.done=!0;if("complete"==document.readyState)UI.onReady();else if(document.addEventListener)if("interactive"==document.readyState&&!UI.B.ie9)UI.onReady();else document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1);UI.onReady()},!1);else if(document.attachEvent){var a=top!=self;a?document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),UI.onReady())}):document.documentElement.doScroll&&!a&&function(){if(!UI.ready.done){try{document.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}UI.onReady()}}()}UI.EA(window,"load",UI.onReady)}},onReady:function(){if(!UI.ready.done){UI.ready.done=!0;for(var a=0,b=UI.readyDo.length;a<b;a++)try{UI.readyDo[a]()}catch(c){}UI.readyDo=null}}};UI.B=function(){var a={},b=navigator.userAgent;a.win=a.win||b.hasString("Win32");UI.each({win:"Windows",mac:"Mac",ie:"MSIE",ie6:"MSIE 6",ie7:"MSIE 7",ie8:"MSIE 8",ie9:"MSIE 9",safari:"WebKit",webkit:"WebKit",chrome:"Chrome",ipad:"iPad",iphone:"iPhone",os4:"OS 4",os5:"OS 5",os6:"OS 6",qq:"QQBrowser",firefox:"Firefox",tt:"TencentTraveler",opera:"Opera"},function(c,f){a[f]=b.hasString(c)});a.ie6=a.ie6&&!a.ie7&&!a.ie8;a.opera=window.opera||a.opera;try{a.maxthon=window.external&&window.external.max_version}catch(c){}return a}();UI.proxyEvent.stop=function(){UI.proxyEventStop=1};window.UI_&&UI_();UI.B.ie&&document.execCommand("BackgroundImageCache",!1,!0);UI._clearCache=[];UI.clear=function(a){UI._clearCache.push(a)};UI.EA(window,"unload",function(){for(var a=0,b=UI._clearCache.length;a<b;a++)UI._clearCache[a]()});UI.isMouseMove();String.prototype.toTitle=function(){return this.replace(/\r/g,"").replace(/\n/g,"").replace(/\'/g,"&#39;").replace(/\"/g,"&#34;").replace(/</g,"&#60;").replace(/>/g,"&#62;")};$=UI.G;$$=UI.GC;function jubao(a){var b="http://jubao.qq.com/cgi-bin/jubao?";""!=a&&(b+=a);var a=UI.html('<div style="width:620px;height:436px;overflow:hidden;border:solid #FFF;border-width:5px 0 10px"><iframe src="about:blank" frameborder="0" scrolling="no" onload="MI.dialog.hideLoad()"></iframe></div>')[0],c=a.firstChild;c.style.cssText="width:628px;height:470px;background:#FFF;margin:-13px 0 0 -5px;-margin-top:-32px;border-style:none";MI.dialog.show({title:"腾讯举报平台",width:670,html:a});MI.dialog.showLoad();c.src=b}try{document.domain="qq.com"}catch(e$$31){}function jubao_onClose(){MI.dialog.hide()}function jubao_msg(a){jubao("appname=micoblog&subapp=web&jubaotype=msg&tw_msg_id="+a+"&tw_name=&tw_vip=&envname=web")}function jubao_user(a){jubao("appname=micoblog&subapp=web&jubaotype=uin&tw_pic_url=&tw_name="+a+"&tw_vip=&envname=web")}onerror=function(a,b,c){var e="";c&&(e+=c+",");a&&(e+=c+",");b&&(e+=b);MI.Bos("btnOnerrorOpen",encodeURIComponent(e));return!0};var PATH="t.qq.com"!=window.location.host?"http://t.qq.com":"";(function(){MIIco=[];MIIcoHtml=[];MI_icon=function(a){return"<%for(var k=0,num=MIIco.length;k<num;k++){if("+a+"[MIIco[k]]){%><%=MIIcoHtml[k]%><%;break;}}%>"};var a={listAll:'<%for(var i=0,n=talk.length;i<n;i++){var numAll,numRelay,numComt;numRelay=talk[i].counts[0]||0;numComt=talk[i].counts[1]||0;if(talk[i].source){numRelay=talk[i].source.counts[0]||0;numComt=talk[i].source.counts[1]||0;}numAll=numRelay+numComt;%><li id="<%=talk[i].id%>"<%if(fav){%> fav="<%=talk[i].favortimestamp%>"<%}%> rel="<%=talk[i].timestamp%>">\t<%if(!guest){%><%if(talk[i].source && talk[i].type==4){%>\t<div class="userPic"><a href="'+PATH+'/<%=talk[i].name%>" title="<%=talk[i].nick.toTitle()%>(@<%=talk[i].name%>)" class="masPic"><img class="crs" crs="<%=talk[i].pic%>" onerror="MI.Pic(this,50)"/></a><a href="/<%=talk[i].source.name%>" title="<%=talk[i].source.nick.toTitle()%>(@<%=talk[i].source.name%>)" class="cusPic"><img class="crs" crs="<%=talk[i].source.pic%>" onerror="MI.Pic(this,50)"/></a></div><%}else{%>\t<div class="userPic"><a href="'+PATH+'/<%=talk[i].name%>" title="<%=talk[i].nick.toTitle()%>(@<%=talk[i].name%>)"><img class="crs" crs="<%=talk[i].pic%>" onerror="MI.Pic(this,50)"/></a></div><%}%>\t<%}%>\t<div class="msgBox"><div class="user_msgCnt"><div class="userName" rel="<%=talk[i].name%>"><strong><a href="'+PATH+'/<%=talk[i].name%>" title="<%=talk[i].nick.toTitle()%>(@<%=talk[i].name%>)"><%=talk[i].nick%></a>'+MI_icon("talk[i].flag")+'<%=talk[i].icon%><%if(!talk[i].source){%>:<%}%></strong><%if(talk[i].source && talk[i].type==2){%>转播:&nbsp;<%}else if(talk[i].source && talk[i].type==7){%>评论:&nbsp;<%}else if(talk[i].source && talk[i].type==4){%>对<strong class="userTo"><a href="/<%=talk[i].source.name%>" title="<%=talk[i].source.nick.toTitle()%>(@<%=talk[i].source.name%>)"><%=talk[i].source.nick%></a>'+MI_icon("talk[i].source.flag")+'说:<%}%></strong></div><div class="msgCnt"><%=talk[i].content||"&nbsp;"%></div></div><%var Imgage=talk[i].image && talk[i].image.length,Videos=talk[i].videos && talk[i].videos.length,Music=talk[i].music && talk[i].music.length;if(Imgage || Videos || Music){%><div class="mediaWrap">\t<%if(Imgage){%><%for(var j=0;j<talk[i].image.length;j++){%>\t<div class="picBox"><a href="http://t.qq.com/p/t/<%=talk[i].id%>" class="pic"><img class="crs" crs="<%=talk[i].image[j]%>/160"/></a></div><%}%>\t<%}%>\t<%if(Videos){%><div class="videoBox" realurl="<%=talk[i].videos[0].realUrl%>" playurl="<%=talk[i].videos[0].playerUrl%>" minipicurl="<%=talk[i].videos[0].miniPicUrl%>" shorturl="<%=talk[i].videos[0].shortUrl%>" reltitle="<%=talk[i].videos[0].title%>">\t<div class="vWrap" thumbs="<%if(iconPic){%>0<%}else{%>1<%}%>"><a href="http://t.qq.com/p/t/<%=talk[i].id%>" class="vThumbsBox"><span class="vThumbs"><span class="mask"><em></em></span><img class="crs" crs="<%=talk[i].videos[0].miniPicUrl%>" /></span><span class="vSimple"><img class="crs" crs="http://mat1.gtimg.com/www/mb/images/vSimple.png" /></span></a></div></div>\t<%}%>\t<%if(Music){%><div class="musicBox" song="<%=talk[i].music[0].sMusicName%>" singer="<%=talk[i].music[0].sMusicAuthor%>" songurl="<%=talk[i].music[0].sMusicUrl%>" songid="<%=talk[i].music[0].dwMusicID%>">\t<a href="http://t.qq.com/p/t/<%=talk[i].id%>" class="mThumbsBox" thumbs="<%if(iconPic){%>0<%}else{%>1<%}%>"><span class="mThumbs"><em class="ico_audios"></em><%=talk[i].music[0].sMusicName%>-<%=talk[i].music[0].sMusicAuthor%></span>\t</a></div>\t<%}%></div><%}%><%if(talk[i].source && talk[i].type==2){%>\t<div class="replyBox"><div class="msgBox">\t<div class="msgCnt"><strong><a href="'+PATH+'/<%=talk[i].source.name%>" title="<%=talk[i].source.nick.toTitle()%>(@<%=talk[i].source.name%>)"><%=talk[i].source.nick%></a>'+MI_icon("talk[i].source.flag")+'<%=talk[i].source.icon%>:</strong><%=talk[i].source.content%></div>\t<%var Imgage=talk[i].source.image && talk[i].source.image.length,Videos=talk[i].source.videos && talk[i].source.videos.length,Music=talk[i].source.music && talk[i].source.music.length;if(Imgage || Videos || Music){%><div class="mediaWrap"><%if(Imgage){%><%for(var j=0;j<talk[i].source.image.length;j++){%>\t<div class="picBox"><a href="http://t.qq.com/p/t/<%=talk[i].source.id%>" class="pic"><img class="crs" crs="<%=talk[i].source.image[j]%>/160" /></a></div><%}%><%}%><%if(Videos){%>\t<div class="videoBox" realurl="<%=talk[i].source.videos[0].realUrl%>" playurl="<%=talk[i].source.videos[0].playerUrl%>" minipicurl="<%=talk[i].source.videos[0].miniPicUrl%>" shorturl="<%=talk[i].source.videos[0].shortUrl%>" reltitle="<%=talk[i].source.videos[0].title%>"><div class="vWrap" thumbs="<%if(iconPic){%>0<%}else{%>1<%}%>"><a href="http://t.qq.com/p/t/<%=talk[i].source.id%>" class="vThumbsBox" ><span class="vThumbs"><span class="mask"><em></em></span><img class="crs" crs="<%=talk[i].source.videos[0].miniPicUrl%>" /></span><span class="vSimple"><img class="crs" crs="http://mat1.gtimg.com/www/mb/images/vSimple.png" /></span></a></div>\t</div><%}%><%if(Music){%>\t<div class="musicBox" song="<%=talk[i].source.music[0].sMusicName%>" singer="<%=talk[i].source.music[0].sMusicAuthor%>" songurl="<%=talk[i].source.music[0].sMusicUrl%>" songid="<%=talk[i].source.music[0].dwMusicID%>"><a href="http://t.qq.com/p/t/<%=talk[i].source.id%>" class="mThumbsBox" thumbs="<%if(iconPic){%>0<%}else{%>1<%}%>">\t<span class="mThumbs"><em class="ico_audios"></em><%=talk[i].source.music[0].sMusicName%>-<%=talk[i].source.music[0].sMusicAuthor%></span></a>\t</div><%}%>\t</div><%}%>\t<div class="pubInfo"><span class="left"><a class="time" rel="<%=talk[i].source.timestamp%>" href="'+PATH+'/p/t/<%=talk[i].source.id%>" target="_blank"><%=talk[i].source.time%></a> <%if(1 && talk[i].source && numAll){%> <a href="'+PATH+'/p/t/<%=talk[i].source.id%>" class="zfNum" target="_blank">查看转播(<b class="relayNum"><%=numAll%></b>)</a>\t<%}%></span></div></div>\t</div><%}%><div class="pubInfo"><span class="left"><a class="time" href="'+PATH+'/p/t/<%=talk[i].id%>" target="_blank"><%=talk[i].time%></a> <%if(1 && !talk[i].source && numAll){%>\t <a href="'+PATH+'/p/t/<%=talk[i].id%>" class="zfNum" target="_blank">查看转播(<b class="relayNum"><%=numAll%></b>)</a><%}%><%if(talk[i].source && talk[i].source.content && talk[i].source.content.length && talk[i].type==4){%>\t<a class="view" href="'+PATH+'/p/r/<%=talk[i].id%>">查看对话</a><%}%><%if(MI.user.fun.report && talk[i].name != MI.user.account){%> <a href="#" class="alarm">举报</a><%}%></span><div class="funBox"><a href="#" class="relay" num="<%=numRelay%>">转播</a><span>|</span><a href="'+PATH+'/p/t/<%=talk[i].id%>" rel="<%=talk[i].id%>" class="comt" num="<%=numComt%>">评论</a>\t</div></div><%if(talk[i].source && talk[i].type==4){%><div class="talkDetail"><b><%=talk[i].source.nick%>:</b> <%=talk[i].source.content%></div><%}%>\t</div></li><%}%>',picTool:'<div class="tools"><a href="#" class="btnBack"><em></em>向左转</a><span>|</span><a href="#" class="btnPrev"><em></em>向右转</a><a href="$Url/2000" class="btnOriginal" target="_blank">查看原图</a></div>',videoTool:'<div class="vTools" style="display:block"><a href="#" class="vClose"><em></em>收起</a><a href="$VideoRealUrl" class="vUrl" target="_blank"><em></em>$VideoTitle</a></div>',videoThumbs:'<a href="#" class="vThumbs" url="$VideoPlayUrl"><span class="mask"><em></em></span><img src="$VideoPicUrl" /></a>',videoObject:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,124,0" width="460" height="372" ><param name="wmode" value="transparent" /><param name="movie" value="$VideoPlayUrl" /><param name="allowScriptAccess" value="never" /><param name="allownetworking" value="internal" /><param name="allowFullScreen" value="true" /><param name="flashvars" value="playMovie=true"></object>',videoEmbed:'<embed src="$VideoPlayUrl" quality="high" pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" width="460" height="372" allowScriptAccess="never" allowFullScreen="true" allownetworking="internal" flashvars="playMovie=true" wmode="transparent"></embed>',videoHTML5:'<video width="460" height="362" controls="1" autoplay="autoplay" autobuffer="true" src="$VideoPlayUrl"></video>',msg:'<%for(var i=0,n=talk.length;i<n;i++){%><li id="<%=talk[i].id%>" rel="<%=talk[i].timestamp%>"><div class="msgBox"><div class="userName">发给 <a href="'+PATH+'/<%=talk[i].name%>" title="<%=talk[i].nick%>(@<%=talk[i].name%>)"><%=talk[i].nick%></a>'+MI_icon("talk[i].flag")+'</div><div class="msgCnt"><%=talk[i].content%></div><div class="pubTime"><span class="time"><%=talk[i].time%></span></div><p class="btnBox"><a href="#" class="replyMsg btn" rel="<%=talk[i].name%>">再写一封</a><a class="btn delBtn" href="#">删除</a></p></div></li><%}%>',msgBox:'<div><table border="0" cellspacing="0" cellpadding="0" class="letterBg"><tr><th>收信人</th><td><div class="txtWrap"><input type="text" name="userName" id="userName" class="msgTo inputTxt" value=""/> <span class="cNote">请输入你的听众的微博帐号</span></div></td></tr><tr><th>内　容</th><td><div class="txtWrap"><textarea type="text" class="inputArea noAutoCmt"></textarea></div></td></tr><tr><th></th><td><input type="button" class="sendBtn inputBtn" value="发送" title="快捷键 Crtl+Enter" /><span class="countTxt"></span></td></tr></table></div>',reply:'<div class="talkWrap"><div class="SA"><em>◆</em><span>◆</span></div><div class="top"><span class="left"><span class="replyTitle"></span>　<span class="addReply"></span></span><a href="#" class="close" title="关闭">关闭</a></div><iframe class="comts" src="about:blank" frameborder="0" scrolling="no" style="height:0"></iframe><div class="cont"><textarea class="inputTxt"></textarea></div><div class="bot"><div class="left" style="margin-right:1ex"><span class="number cNote"></span></div><div class="left"></div><input type="button" class="inputBtn sendBtn" value="" /><span class="countTxt"></span></div><div class="talkSuc" style="display:none"><span class="ico_tsW"><span class="ico_ts"></span></span><span class="msg"></span></div></div>',black:'<div class="blackTip"><h2><span class="ico_tsW"><span class="ico_te"></span></span>确定将<%=sex%>拉入黑名单？</h2><p><span class="fs14">拉黑之后...</span><br/>你们之间的收听关系将被解除，对方无法再收听你，而且你也不再收到来自<%=sex%>的任何消息与通知</p><p><input type="button" value="确定" id="blackTipBtn" /><input type="button" value="取消" onclick="MI.dialog.hide()"/></p></div>',unblack:'<div class="blackTip"><h2><span class="ico_tsW"><span class="ico_te"></span></span>你真的原谅<%=sex%>了吗？</h2><p><span class="fs14">取消之后...</span><br/>你会重新收到来自<%=sex%>的私信和其它通知</p><p><input type="button" value="确定" id="blackTipBtn"/><input type="button" value="取消" onclick="MI.dialog.hide()"/></p></div>',card:'<div class="uCard"><div class="tip">这是你自己</div><div class="tip"></div><div class="userPic"><a></a><p class="btn"><input type="button" class="addAttention" value="" /><a href="#" class="delAttention" title="取消收听">取消</a></p></div><div class="uCardcnt"><p class="userName"></p><p class="nums loading"></p><p class="btn"><a href="#" class="reply">对话</a><a href="#" class="msg">私信</a><a href="#" class="black">拉黑</a></p><div class="tagBox"></div><a href="#" class="ico_sFo"></a></div></div>',code:'<div class="verify"><span class="ico_tsW"><span class="ico_te"></span></span><h3></h3><div class="clear"><form><div class="left">验证码：</div><div class="verifyInput"><input type="text" class="inputTxt" /><div class="cNote">输入下图中的字符，不区分大小写</div><img width="130" height="53">&nbsp;<a href="#" class="codeChange">看不清，换一张</a></div></div><div class="btnBox"><button type="submit" class="btn2">确定</button><button class="btn2">取消</button></form></div></div>'},b={ui:{DatePicker:"100827"},mi:{City:"100831",CityAll:"100831",Validate:"101115",ValidateNew:"101115",RelateSelect:"100921",Slide:"100806",College:"101012",Theme:"100913",Tag:"101122",List:"101129",SettingEdu:"101117",SettingWork:"101117",Music:"101130",QQMusicInstance:"101022",QQMusicPlayer:"101022",QQMusicWmpPlayer:"101022",QQMuicHtml5Player:"101022"}},c={ui:{datePicker:"100827"}},e={},f;for(f in b)for(var g in b[f])e[g]="http://mat1.gtimg.com/www/mb/js/"+f+"."+g+"_"+b[f][g]+".js";for(f in c)for(g in c[f])e[g]="http://mat1.gtimg.com/www/mb/css/"+g+"_"+c[f][g]+".css";MI={time:null,user:{fun:{}},string:{length:function(a){var b=a.match(/[^\x00-\x80]/g);return a.length+(b?b.length:0)},escape:function(a){return MI.string.html(a).replace(/'/g,"\\'")},escapeReg:function(a){for(var b=[],c=0;c<a.length;c++){var j=a.charAt(c);switch(j){case ".":b.push("\\x2E");break;case "$":b.push("\\x24");break;case "^":b.push("\\x5E");break;case "{":b.push("\\x7B");break;case "[":b.push("\\x5B");break;case "(":b.push("\\x28");break;case "|":b.push("\\x28");break;case ")":b.push("\\x29");break;case "*":b.push("\\x2A");break;case "+":b.push("\\x2B");break;case "?":b.push("\\x3F");break;case "\\":b.push("\\x5C");break;default:b.push(j)}}return b.join("")},html:function(a){return a.replace(/</g,"&lt;").replace(/>/g,"&gt;")},cut:function(a,b,c){var c=UI.isUndefined(c)?"...":c,j=[],e="";if(MI.string.length(a)>b){for(var a=a.split(""),e=0,f=a.length;e<f;e++)if(0<b)j.push(a[e]),b-=MI.string.length(a[e]);else break;e=j.join("")+c}else e=a;return e},id:function(a){return a.match(/[^\/]+$/g)[0].replace("#M","")}},number:{format:function(a){return(a+"").replace(/(?=(?!\b)(?:\w{3})+$)/g,",")}},random:function(a){return parseInt((new Date).getTime()/(a||1))},drop:{},delay:{},validate:{},canvas:{},focus:function(a){var b=a.value.length;a.focus();MI.selectTxt(a,b,b,b)},blur:function(){this.blur()},click:function(){return!1},hideFocus:function(){UI.A(this,"hideFocus","true");this.onmouseover=null},boss:null,ajax:0,talkNew:[],talkMore:[],crs:[],lazy:{},bannerTips:function(a){var a=a||MI.bannerTipsCache,b=a.banner,c=a.tips,e=$("talkBox");if(b&&e){UI.css("#homeBannerTip{position:relative;width:576px;height:129px;margin:9px 0 0 9px;background:url("+b.pic+") 50% 50% no-repeat;overflow:hidden;}#homeBannerTip .content{display:block;width:526px;height:61px;*zoom:1;padding:68px 23px 0 27px;color:#fff;line-height:20px;text-decoration:none}#homeBannerTip .close{float:none;position:absolute;margin:0;top:10px;right:13px}");var f="UI.ajax({url:'/asyn/updateTips.php',data:{id:"+b.id+",status:0}});",b=UI.html('<div id="homeBannerTip"><a href="#" onclick="UI.hide(\'homeBannerTip\');'+f+'return false" class="close" title="关闭"></a>\t<a'+(b.blank?' target="_blank"':"")+' href="'+b.url+'" title="'+(b.title||"")+'" onclick="'+(b.close?f:"")+"MI.Bos('homeBannerTip_"+b.id+'\');" class="content"></a></div>')[0];UI.after(b,e);delete a.banner}if(c&&(e=$$(c.target)[0]))c.content='<div class="mdTips"><a href="#" class="close TipsClose" onclick="return false">关闭</a><div class="SA"><em>◆</em><span>◆</span></div><div class="cntBox"><div class="ico ico_light"></div><p>体验围脖名单新功能？<br><em class="ffsong">·</em>点击创建，制作各种有趣的人名单<br><em class="ffsong">·</em>点击名单广场，围观大家的精彩名单</p><p class="links"><a href="http://user.qzone.qq.com/20100401/blog/1289549179" target="_blank">使用帮助</a><a href="#" class="TipsClose">不再提醒</a></p></div></div>',c.css=".sideFun{position:relative;z-index:10;overflow:visible}.mdTips{position:absolute;z-index:999;top:-112px;right:-3px;width:210px;padding:10px 20px 10px 40px;border:1px solid #F0E5BA;background:#FFFFE9}.mdTips .close{position:absolute;float:none;margin-top:-2px;right:10px}.mdTips p{text-align:left;color:#333}.mdTips .links{text-align:right}.mdTips .SA{position:absolute;left:210px;top:auto;bottom:9px}.mdTips .SA em,.mdTips .SA span{width:17px;height:19px;color:#F0E5BA}.mdTips .SA span{top:-1px;left:0;color:#FFFFE9}.mdTips .links a{font-size:12px;margin:3px 0 0 20px;color:#2B4A78;text-decoration:underline}.mdTips .ico_light{position:absolute;left:14px;margin-top:5px}",UI.css(c.css),c=UI.html(c.content)[0],UI.after(c,e),UI.each($$(c,".TipsClose"),function(a){a.onclick=function(){UI.ajax({url:"/asyn/updateTips.php",data:{t:18,v:1}});return!1}});MI.bannerTipsCache=a},json:function(a){var b={};try{b=eval("("+a+")")}catch(c){}return b},tmpl:a,selectTxt:function(a,b,c){document.createRange?a.setSelectionRange(b,c):(a=a.createTextRange(),a.collapse(1),a.moveStart("character",b),a.moveEnd("character",c-b),a.select())},insertTxt:function(a,b,c,e){void 0==e&&(e=0);a.focus();if(document.selection)a=document.selection.createRange(),a.moveStart("character",-e),a.text=b;else{var f=a.value,m=c+b.length-e;a.value=f.substring(0,c-e)+b+f.substring(c,f.length);MI.selectTxt(a,m,m,m)}},cursorX:function(a){if(document.selection){var b=document.selection.createRange(),c=0;b.moveStart("character",-a.value.length);a=b.text.split("");return c=a[a.length-1].replace(/\r/g,"").length}return a.selectionStart},countNum:function(a,b,c){if(a&&!a.innerHTML.hasString("超过")){var e=a.innerHTML.replace(/\D/g,"")||0,e=c?MI.number.format(parseInt(e.replace(/,/g,""))+b):parseInt(e)+b;a.innerHTML=0>e?0:e}},fC:{numFormat:[],num:[]},follow:function(a,b,c,e){MI.fC.init||(MI.fC.numFormat=$$(".followNumFormat"),MI.fC.num=$$(".followNum"),MI.fC.init=1);if(!b.sending){var f=-1,m;m=b.className;var g=$("followedNum_"+a),p=$("followNum_"+a),r="addAttention"!=m&&"delAttention"!=m;"addAttention"==m||r?(f=1,m="/follow.php"):m="/unfollow.php";b.sending=1;UI.ajax({url:m,data:{u:a,r:MI.random(),veriCode:e||""},success:function(e){b.sending=0;e=MI.json(e);if(e.result==0){if(!r)b.className=f==1?"delAttention":"addAttention";g&&MI.countNum(g,f);p&&MI.countNum(p,f);for(var e=0,j=MI.fC.numFormat.length;e<j;e++)MI.countNum(MI.fC.numFormat[e],f,1);e=0;for(j=MI.fC.num.length;e<j;e++)UI.A(MI.fC.num[e],"rel")==a&&MI.countNum(MI.fC.num[e],f);c&&c(f);b.value=f==1?"取消收听":"收听"}else e.result==-100?MI.code.show({msg:e.msg,code:e.info,call:function(e){MI.follow(a,b,c,e)}}):e.msg&&MI.alert(e.msg)}})}},sFollow:function(a,b,c){var e=UI.hasClass(b,"foLight")?0:1;b.sending||(UI.ajax({url:"/asyn/group_oper.php",data:{u:a,op:e},success:function(a){a=MI.json(a);0==a.result?(e?(UI.addClass(b,"foLight"),b.title=MI.sFollowTip[1]):(UI.removeClass(b,"foLight"),b.title=MI.sFollowTip[0]),c&&c(e)):MI.alert(a.msg);b.sending=0}}),b.sending=1)},sFollowTip:["添加到特别收听","取消特别收听"],black:function(a){var b,c=UI.hasClass(a.target,"blackDel")?1:0,e=c?"un":"",f=["拉黑名单","取消拉黑"];MI.dialog.show({width:420,html:(new UI.tmplString(MI.tmpl[e+"black"]))(a)});a.txt=UI.isUndefined(a.txt)?1:a.txt;UI.isArray(a.txt)&&(f=a.txt);b=$("blackTipBtn");b.focus();b.onclick=function(){var b=this;if(!b.sending){UI.ajax({url:"/asyn/"+e+"block.php",data:{u:a.u,r:MI.random()},success:function(i){i=MI.json(i);if(i.result==0){if(a.txt)a.target.innerHTML="<b></b>"+(c?f[0]:f[1]);c?UI.removeClass(a.target,"blackDel"):UI.addClass(a.target,"blackDel");MI.dialog.hide();a.call&&a.call(c)}else MI.alert(i.msg);b.sending=0}});b.sending=1}}},topic:function(a,b,c){if(!b.sending){var e=c||UI.hasClass(b,"delAttention");UI.ajax({url:"/asyn/topic.php",data:{tid:a,type:e?"2":"1",r:MI.random()},success:function(f){f=MI.json(f);if(0==f.result){if(c){var m=b.parentNode;UI.animate(m,"opacity",0,function(){UI.remove(m);MI.updateTopic()})}else b.className=e?"addAttention":"delAttention",b.value=e?"收听":"取消收听",MI.updateTopic();MI.countNum($("followedNum_"+a),e?-1:1)}else MI.alert(f.msg);b.sending=0}})}b.sending=1},topicDel:function(a,b){MI.topic(a,b,1)},topicOp:function(a,b,c){if(b){if(!b.sending){var e=c||"1"==UI.A(b,"fo");UI.ajax({url:"/asyn/messageSearch.php",data:{type:e?3:2,name:a,r:MI.random()},success:function(a){a=MI.json(a);if(0==a.result)if(c){var h=b.parentNode;UI.animate(h,"opacity",0,function(){UI.remove(h);MI.updateTopic()})}else b.innerHTML=e?"+订阅关键词":"-取消订阅",UI.A(b,"fo",e?"0":"1"),MI.updateTopic();b.sending=0}})}b.sending=1}},updateTopic:function(a,b){if(a=a||$("gzTopic")){var c=a.unfold||0;b&&(c=c?0:1);var e="t=topic&unfold="+c+"&r="+MI.random();UI.get("/asyn/mysidebar.php",e,function(e){e=MI.json(e);0==e.result&&(e.info&&e.info.topic&&(b&&(a.unfold=c),a.innerHTML=e.info.topic),MI.Load.bottom())});b&&MI.Bos(c?"btnMoreSub":"btnLessSub")}},newCount:function(a){function b(){6>c&&UI.get("/asyn/newMsgCount.php","type="+a+"&r="+MI.random(),function(a){a=MI.json(a);if(0==a.result){var b,h,e,i,f;UI.each(a.info,function(a){h=a.value;if(1==a.type)if((b=$("newCountFollower"))&&h){var c=b.firstChild;$("followerNum");e=999;c.innerHTML=h>e?"<strong>"+e+"</strong>+":"+<strong>"+h+"</strong>";c.title="有"+(h>e?"超过"+e:h)+"个新听众";UI.addClass(UI.next(c),"bubble");UI.show(b)}else b&&UI.hide(b);if(2==a.type&&(b=$("newCoutMsg")))b.innerHTML=b&&h?"("+h+")":"";if((3==a.type||5==a.type)&&!MI.noNewCount&&MI.talkList&&MI.talkList._new)e=5E4,i=h>e?"超过<strong>"+e+"</strong>条的":"<strong>"+h+"</strong>条",f=MI.talkList._new,f.innerHTML='<a href="javascript:void(0)" tabindex="4">有'+i+"新广播，点击查看</a>",document.titleTmp||(document.titleTmp=document.title),document.title=h>e?"("+e+"+) "+document.titleTmp:(h?"("+h+") ":"")+document.titleTmp,h?f.style.display="block":UI.hide(f),f.num!=h&&(UI.C(f,"opacity",0),UI.animate(f,"opacity",1)),f.num=h;if(4==a.type&&(b=$("newCoutAt")))b.innerHTML=b&&h?"("+h+")":""});c=0}else-1==a.result&&c++})}a=a||"4,3,2,1";setInterval(b,3E4);setTimeout(function(){b()},10);var c=0},addHover:function(a){var b,c;a.onmouseover=function(){var a=this;clearTimeout(c);b=setTimeout(function(){UI.addClass(a,"hover")},20)};a.onmouseout=function(){var a=this;clearTimeout(b);c=setTimeout(function(){UI.removeClass(a,"hover");UI.removeClass(a,"newMsg")},20)}},bottom:function(a){var b=$$(".main .LC"),c=UI.parents($(a),"main")[0],e,f=0;c&&(e=c.parentNode);b.length||(b=$$(".LC"));if((b=b[b.length-1])&&UI.height($(a)))UI.C(b,"marginBottom",0),c?f=UI.height(c)-UI.height(e):(e=$("mainWrapper"),UI.each(e.childNodes,function(a){a.nodeType==1&&(f=f+UI.height(a))}),f-=UI.height(e)),UI.C(b,"marginBottom",0>f?-f+"px":"")},viewSet:function(a){var a=$(a),b=$$(a,"button"),c=$$(a,"input");MI.dialog.show({title:'<h1 class="DmainTit">浏览设置</h1>',html:a,width:380});setTimeout(function(){b[0].focus()},0);MI.Bos("btnViewSet");b[0].onclick=function(){var a=UI.parseUrl(),b=[];UI.each(c,function(b){b.checked&&(a[UI.A(b,"name")]=b.value)});for(var e in a)b.push(e+"="+(a[e]||""));document.location.href=document.location.pathname+"?"+b.join("&")};b[1].onclick=function(){MI.dialog.hide()}},goHome:function(){document.location.href=PATH+"/"+MI.user.account},alert:function(a,b){a&&MI.dialog.alert(a,b)},tip:function(a,b){a&&MI.dialog.showTip({html:a,end:b})},confirm:function(a){a&&(a.type="success"==a.type?"s":"e",a.title=a.title||"",a.content=a.content||"",a.confirmTxt=a.confirmTxt||"确定",a.cancelTxt=a.cancelTxt||"取消",MI.confirm.html&&(UI.remove(MI.confirm.html),MI.confirm.html=null),MI.confirm.html=UI.html('<div class="blackTip"><h2><span class="ico_tsW"><span class="ico_t'+a.type+'"></span></span>'+a.title+"</h2><p>"+a.content+'</p><p><input type="button" value="'+a.confirmTxt+'" id="__confirmBtn__" /><input type="button" value="'+a.cancelTxt+'" id="__cancelBtn__" /></p></div>')[0],MI.dialog.show({html:MI.confirm.html,width:a.width||410}),a.confirm&&($("__confirmBtn__").onclick=a.confirm),$("__cancelBtn__").onclick=function(){MI.dialog.hide();a.cancel&&a.cancel.apply(this)},setTimeout(function(){$("__confirmBtn__").focus()},100))},version:e,versionSet:function(a){for(var b in a){var c=MI.version[b],e;c&&(e=c.split("_"),c=e[0],e=e[1].split(".")[1],MI.version[b]=c+"_"+a[b]+"."+e)}},app:function(a){for(var b in a)MI._app[b]=a[b];MI.appLoaded&&MI.appLoad()},_app:{},appLoad:function(){var a,b;for(b in MI._app)if(MI[b]){if(MI._app[b])MI._app[b]()}else UI.getScript(MI.version[b],MI._app[b]),(a=MI.version[b.slice(0,1).toLocaleLowerCase()+b.slice(1)])&&UI.getCss(a);MI.appLoaded=1;MI._app={}},appLoaded:0,jumpEvent:function(a){UI.each(a,function(a){var b=config.pref?config.pref:"qqcom.radiowb",c=UI.A(a,"href");c.hasString("qq.com")&&!c.hasString(b)&&(UI.B.ie6&&(c=encodeURI(UI.utfDecode(c))),UI.A(a,"href",(UI.B.ie?" ":"")+c+(c.hasString("?")?"&":"?")+"pref="+b))})},SmartBox:function(a,b,c,e){if($(a)){var f=this;this._callback=b?b:null;this._key=$(a);this.url="/asyn/messagetips.php";this._type=c?c:"";this._fix=UI.B.ie?[0,0]:[1,2];this.param="key=%key%";this._style=e?e:{left:0,top:0,width:306};this._pos={x:UI.getX(this._key),y:UI.getY(this._key)};this._select=UI.html('<div class="smartBox"></div>')[0];this._list=[];UI.append(this._select,document.body);this._key.blur();f.hide();if(this.tip=(this._tip=this._key.previousSibling)&&"LABEL"==this._tip.nodeName)this._tip.onclick=function(){f._key.focus()};UI.EA(document.body,"click",function(){f.hide()});UI.EA(this._key,"focus",function(){f.tip&&UI.hide(f._tip);f.isDisplay||f.hide();f.getMsg(f._key.value)});UI.EA(this._key,"blur",function(a){a=UI.E(a).target;f.tip&&!a.value&&UI.show(f._tip);setTimeout(function(){f.hide()},500)});this._key.onbeforeeditfocus=function(){f.isDisplay||f.hide()};this._key.onclick=function(a){UI.E(a).stop()};this._key.onkeydown=function(a){a=UI.E(a);if(f.isDisplay)if(40==a.key||38==a.key)38==a.key?f.index=0>f.index-1?f.indexMax:f.index-1:40==a.key&&(f.index=f.index+1>f.indexMax?0:f.index+1),this.value=f._list[f.index].innerHTML,f.select(f.index);else{if(13==a.key||27==a.key)27==a.key?f.hide():f.select()}else UI.trim(this.value)&&(0<f._list.length&&(40==a.key||38==a.key)?f.show():f.getMsg(this.value))};this._key.onkeyup=function(a){a=UI.E(a);40==a.key||(38==a.key||13==a.key||27==a.key)||f.getMsg(this.value)}}}};MI.SmartBox.prototype={lastOrigin:null,isDisplay:!1,timer:null,index:-1,indexMax:0,hide:function(){UI.hide(this._select);this.isDisplay=!1},show:function(){MI.user.fun.search&&(this.resize(),UI.show(this._select),this.isDisplay=!0)},select:function(a){this.index=a;this._list[this.index]&&UI.addClass(this._list[this.index],"on");this.lastOrigin&&UI.removeClass(this.lastOrigin,"on");this.lastOrigin=this._list[this.index]},resize:function(){this._pos={x:UI.getX(this._key),y:UI.getY(this._key)};this._select.style.width=this._style.width+"px";this._select.style.left=this._pos.x+this._style.left+this._fix[0]+"px";this._select.style.top=this._pos.y+this._key.offsetHeight+this._style.top-this._fix[1]+"px"},getMsg:function(a){var b=this;if(UI.trim(a)){var c=this.param.replace(/\%key\%/g,encodeURIComponent(a));this.timer&&clearTimeout(this.timer);this.timer="music"==this._type?window.setTimeout(function(){UI.getScript(b.url+"?"+c)},150):window.setTimeout(function(){UI.get(b.url,c,function(a){a=MI.json(a);if(0==a.result)if(a.info){var c=[];b.indexMax=a.info.length-1;b.index=-1;c.push("<ul>");for(var e in a.info)c.push('<li value="'+a.info[e]+'" index="'+e+'">'+a.info[e]+"</li>");c.push("</ul>");2!=c.length&&(b._select.innerHTML=c.join(""),b.show(),b._list=$$(b._select,"li"),UI.each(b._list,function(a,c){a.onmouseover=function(){b.select(c)};a.onclick=function(){b._key.value=this.innerHTML;UI.A(b._key,"index",UI.A(this,"index"));b.submit()}}))}else b.hide();else b.hide()})},150)}else b.hide()},submit:function(){this._callback&&this._callback()}};MI.AutoCmt=function(a){function b(a){UI.E(a);clearTimeout(e.delay);e.delay=setTimeout(function(){var a,b,f;b=e._target.value;if(0<e.clicks)e.clicks--;else if(e.cursorX=MI.cursorX(e._target),b=b.replace(/\r/g,""),a=b.slice(0,e.cursorX).replace(/＠/,"@"),!e.key&&a.match(/^@/)?(e.filter="@",a=a.replace(/^@/,"")):e.filter="",b=b.slice(e.cursorX),e.word=e.key?a.match(/@[^\s@\n\r]{0,64}$/g):a.match(/[^\s\n\r]{0,64}$/g),e.word){e.word=e.word[0];f=e.word.length;1<f&&(a=a.slice(0,-f+1));e._txt.innerHTML=e.key?a.replace(/\r\n|\n/g,"<br>").replace(/ /g,"&nbsp;"):"";e._txtEnd.innerHTML=b.replace(/\r\n|\n/g,"<br>").replace(/ /g,"&nbsp;");e._body.appended||(UI.append(e._body,document.body),e._body.appended=1,UI.EA(window,"beforeunload",function(){var a="top_"+MI.user.account;if(MI.isS){var b=[],c;for(c in MI.users)b.push(c+":"+MI.users[c]);MI.S(a,"{"+b.join(",")+"}")}}));var h="follow_"+e.type+"_"+MI.user.account;a="top_"+MI.user.account;var i=h+"_PY";b=MI.S(h);f=MI.S(a);MI.isS&&((f||MI.S(a,"{}"),MI.users||(MI.users=MI.json(MI.S(a)),e.sort()),!e.sending&&(!b||72E5<(new Date).getTime()-MI.S("time")||-1==b.indexOf("]]}")))?(e.sending=1,UI.get("/asyn/nicktips.php","user="+MI.user.account+"&type="+(e.type?e.type:0)+"&num="+(UI.B.ie?1E3:2E3),function(a){var b=MI.json(a);if(b.result==0){MI.S(h,a);MI.S("time",(new Date).getTime());a=c(b);MI[h]=a[0];MI[i]=a[1];e.show(MI[h],MI[i])}e.sending=0})):(MI[h]||(a=c(MI.json(b)),MI[h]=a[0],MI[i]=a[1]),e.show(MI[h],MI[i])))}else clearTimeout(e.delay),e.hide()},150)}function c(a){var b={info:{}},e={};if(UI.isArray(a.info))for(var h=0;h<a.info.length;++h)b.info[a.info[h][0]]=a.info[h][1],a.info[h][2]&&(e[a.info[h][0]]=[a.info[h][2].toLowerCase(),MI.MatchPY.whole2sim(a.info[h][2])]);else b=a;return[b,e]}var e=this;e._target=a.target;e.key=a.key;e.call=a.call;e.clickCall=a.clickCall;e.type=a.type||0;e.align=a.align||"left";e.minWidth=a.minWidth;e._shadow=UI.html('<div class="txtShadow"><span></span><b>|</b><span></span></div>')[0];UI.after(e._shadow,a.target);e._txt=e._shadow.firstChild;e._cursor=e._txt.nextSibling;e._txtEnd=e._shadow.lastChild;UI.B.ie&&UI.before(UI.html('<b style="display:none;width:0;overflow:hidden"></b>')[0],a.target);UI.EA(a.target,"keydown",function(a){if(e.display&&UI.isNumber(e.index))if(a=UI.E(a),40==a.key||38==a.key)UI.removeClass(e.list[e.index],"on"),38==a.key?e.index--:40==a.key&&e.index++,0>e.index?e.index=e.indexMax:e.index>e.indexMax&&(e.index=0),UI.addClass(e.list[e.index],"on"),e._body.scrollTop=21*(e.index-4),e.clicks=1,clearTimeout(e.delay),a.prevent();else if(13==a.key||27==a.key)27==a.key?e.hide():e.select(),e.clicks=1,clearTimeout(e.delay),a.prevent()});UI.EA(document.body,"click",function(){e.hide()});UI.EA(a.target,"keyup",b);UI.EA(a.target,"focus",b);UI.EA(a.target,"mouseup",b)};MI.AutoCmt.prototype={_body:UI.html('<ul class="autoCmt" style="display:none"></ul>')[0],display:0,clicks:0,index:0,filter:"",select:function(){if(UI.isNumber(this.index)){var a=this._target.scrollTop,b=this.list[this.index].txt,c;this._target.focus();MI.insertTxt(this._target,b+" ",this.cursorX,this.word.slice(1).length);c=MI.users[b];MI.users[b]=c?c+1:1;this.key||(this._target.value=this.filter+b);this.call&&this.call();this._target.scrollTop=a;this.hide()}},show:function(a,b){function c(){f.select();f.clickCall&&f.clickCall()}function e(a){a=UI.E(a);"LI"==a.target.nodeName&&(null==f.index&&(f.index=0),UI.removeClass(f.list[f.index],"on"),UI.addClass(a.target,"on"),f.index=a.target.index)}var b=b||{},f=this,g=[],o=0,p=this.key?this.word.slice(1):this.word,r=MI.string.escapeReg(p),t=RegExp("(^"+r+")","i"),r=RegExp("("+r+")","ig"),s=0,q=[],v={},u=a.info;if(p){for(var l in u){if(40<=o)break;if(l.match(t)||u[l].match(t))g.push(u[l].replace(t,"<b>"+RegExp.$1+"</b>")+" ("+l.replace(t,"<b>"+RegExp.$1+"</b>")+")"),q.push(l),v[l]=1,o++;s++}if(40>o){var t=p.toLowerCase(),w;for(l in u){if(40<=o)break;if(b[l]&&!v[l]){if(w=MI.MatchPY.sim(b[l][1],t))g.push(u[l].substring(0,w[0])+"<b>"+u[l].substring(w[0],w[0]+w[1])+"</b>"+u[l].substring(w[0]+w[1])+" ("+l+")"),q.push(l),v[l]=1,o++;s++}}}if(40>o)for(l in t=p.toLowerCase(),u){if(40<=o)break;if(b[l]&&!v[l]){if(w=MI.MatchPY.whole(b[l][0],t))g.push(u[l].substring(0,w[0])+"<b>"+u[l].substring(w[0],w[0]+w[1])+"</b>"+u[l].substring(w[0]+w[1])+" ("+l+")"),q.push(l),v[l]=1,o++;s++}}if(40>o)for(l in u){if(40<=o)break;if((l.slice(1).match(r)||u[l].slice(1).match(r))&&!v[l])g.push(u[l].replace(r,"<b>"+RegExp.$1+"</b>")+" ("+l.replace(r,"<b>"+RegExp.$1+"</b>")+")"),q.push(l),v[l]=1,o++;s++}}else if(MI.usersArr){this.sort();l=0;for(p=MI.usersArr.length;l<p&&!(10<=l);l++)if(r=MI.usersArr[l].account,s=a.info[r])g.push(s+" ("+r+")"),o++,q.push(r)}o?(10<o?(this._body.style.cssText="height:210px;overflow-y:scroll;overflow-x:hidden;",this._body.scrollTop=0):this._body.style.cssText="",this._body.innerHTML='<li class="on"><span>'+g.join("</span></li><li>")+"</span></li>",this.list=this._body.childNodes,UI.each(this.list,function(a,b){UI.EA(a,"click",c);UI.EA(a,"mouseover",e);a.txt=q[b];a.index=b}),this.index=this.display=0,this.indexMax=this.list.length-1,this.display||(this.key?(g=UI.getX(this._cursor)-12,o=UI.getY(this._cursor)-this._target.scrollTop+26):(g=UI.getX(this._target),o=UI.getY(this._target)+UI.height(this._target)-1),this.minWidth&&UI.width(this._body)<=this.minWidth&&(this._body.style.width=this.minWidth+"px"),"right"==this.align&&(g-=UI.width(this._body)-UI.width(this._target)),this._body.style.cssText+=";top:"+o+"px;left:"+g+"px"),this.display=1):(this._body.innerHTML="",this.indexMax=0,this.hide())},hide:function(){this.display&&(UI.hide(this._body),this.index=null)},sort:function(){delete MI.usersArr;var a=[],b;for(b in MI.users)a.push({account:b,count:MI.users[b]});MI.usersArr=a.sort(function(a,b){return b.count-a.count})}};MI.MatchPY={sp:"|",sim:function(a,b){var c=a.indexOf(b);return-1==c?null:[c,b.length]},whole:function(a,b){var c=a.split(this.sp),e=c.join(""),f=c.length;if(1==f)return e==b?[0,1]:null;for(var g=0;g<f;++g){if(this.startsWith(e,b))return[g,this.len(c,g,b)];e=e.substring(c[g].length)}return null},whole2sim:function(a){for(var a=a.split(this.sp),b="",c=0;c<a.length;++c)b+=a[c].charAt(0)||"?";return b.toLowerCase()},len:function(a,b,c){for(var c=c.length,e=0,f=a.length,g=b;g<f;++g){e+=a[g].length;if(c==e)return g-b+1;if(c<e)return g-b}return f},startsWith:function(a,b){return 0==a.lastIndexOf(b,0)}};MI.Dialog=function(a){var a=a||{},b=this;b._body=UI.html(a.tmpl||'<div class="D">'+(UI.B.ie6?'<iframe src="javascript:false;" class="cover_select"></iframe>':"")+'<div class="bg"></div><div class="CR"><table border="0" cellspacing="0" cellpadding="0" class="tbSendMsg"><tr><td class="tl"></td><td class="tm"></td><td class="tr"></td></tr><tr><td class="lm"></td><td><div class="DWrap"><div class="DTitle"></div><a title="关闭" class="DClose close" href="#">关闭</a><div class="DLoad"></div><div class="DCont"></div></div></div></td><td class="rm"></td></tr><tr><td class="bl"></td><td class="bm"></td><td class="br"></td></tr></table></div></div>')[0];b._bg=b.$(".bg");b._cover=b.$(".cover_select");b._wrap=b.$(".CR");b._title=b.$(".DTitle");b._close=b.$(".DClose");b._cont=b.$(".DCont");b._load=b.$(".DLoad");b.resizeBg=function(){b.display&&(UI.B.ie&&(b._bg.style.cssText+=";width:100%;"),b.delay=setTimeout(function(){var a=UI.pageHeight(),c=UI.windowHeight();b._bg.style.cssText=b._bg.style.cssText+(";margin-left:0;width:"+UI.pageWidth()+"px;height:"+(a<c?c:a)+"px;");if(UI.B.ie6)b._cover.style.cssText=b._bg.style.cssText},0))};var c=b._wrap;b._title.onmousedown=b._title.ontouchstart=function(a){var a=UI.E(a),b=a.x-parseInt(c.style.marginLeft),e=a.y-parseInt(c.style.marginTop),f=UI.windowWidth(),h=UI.windowHeight();a.prevent();document.onmousemove=document.ontouchmove=function(a){a=UI.E(a);if(!UI.B.ie&&(0>a.x||0>a.y||a.x>f||a.y>h))return!1;c.style.marginTop=a.y-e+"px";c.style.marginLeft=a.x-b+"px";return!1};document.onmouseup=document.ontouchend=function(){document.onmousemove=document.ontouchmove=null;document.onmouseup=document.ontouchend=null};return!1};UI.EA(window,"resize",b.resizeBg);b._close.onclick=function(){b.hide();return!1}};MI.Dialog.prototype={width:462,close:1,show:function(a){var b=this,c;b._append||(document.body.appendChild(b._body),b._append=1);b.close=void 0!=a.close?a.close:b.close;b.ico=a.ico;b.close?UI.show(b._close):UI.hide(b._close);b._title.innerHTML=a.title||"";UI.C(b._title,"height",a.title?"":"0");if(a.html)for(var e=0,f=b._cont.childNodes.length;e<f;e++){var g=b._cont.childNodes[e];1==g.nodeType&&(UI.hide(g),UI.append(g,document.body))}UI.isString(a.html)?b._cont.innerHTML=a.html:UI.isObject(a.html)&&(UI.append(a.html,b._cont),UI.show(a.html));a.width&&(b.width=a.width);a.height&&(b.height=a.height);UI.C(b._wrap,"width",b.width+"px");UI.C(b._wrap,"opacity",0);UI.show(b._body);b.height&&UI.C(b._cont,"height",b.height+"px");c="width:"+b.width+"px;margin:"+(UI.scrollY()-UI.height(b._wrap)/2)+"px 0 0 -"+b.width/2+"px;";void 0!=a.left&&(c+="left:"+a.left+"px;margin-left:0;");void 0!=a.top&&(c+="top:"+a.top+"px;margin-top:0;");setTimeout(function(){b.resizeBg();b._wrap.style.cssText=c},0);b._wrap.style.cssText=c;a.html&&(a.start&&a.start(),b.end=a.end?a.end:null,this.call&&this.call());b.display=1;UI.B.firefox||UI.C(UI.B.ie?document.documentElement:document.body,"overflowX","hidden")},hide:function(){UI.hide(this._body);this.hideLoad();this.end&&this.end();this.display=0;UI.B.firefox||UI.C(UI.B.ie?document.documentElement:document.body,"overflowX","auto")},showLoad:function(a,b,c,e,f){var a=a||this._cont,g="",e=e||UI.width(a),f=f||UI.height(a);UI.isNumber(b)&&(g+="top:"+b+"px;");UI.isNumber(c)&&(g+="left:"+c+"px;");this._load.style.cssText="width:"+e+"px;height:"+f+"px;"+g},hideLoad:function(){UI.hide(this._load)},showTip:function(a){var b=this,c=b.close;a.close=0;a.html='<div class="popBox"><span class="ico_tsW"><span class="'+(a.ico?a.ico:"ico_ts")+'"></span></span><h2>'+a.html+"</h2><p></p></div>";a.end=a.end||b.end;b.show({width:9999});b.show(a);b.show({width:UI.width(b._cont)+40});setTimeout(function(){b.hide();b.close=c},a.delay?a.delay:1E3)},alert:function(a,b){var c=this,e;c.show({width:9999});c.show({html:'<div class="popBox"><span class="ico_tsW"><span class="ico_te"></span></span><h3>'+a+'</h3><p><input type="button" value="知道了" onclick="MI.dialog.hide()"></p></div>',end:b});setTimeout(function(){c.show({width:UI.width(c._cont)+40});(e=$$(c._cont,"input")[0])&&e.focus()},0)},$:function(a){return $$(this._body,a)[0]}};MI.S=function(a,b){try{if(window.localStorage)if(void 0!=b)localStorage[a]=b;else return localStorage[a]||"";else if(UI.B.ie){var c=MI.S._body;c.appended||(document.body.appendChild(c),c.appended=1);try{c.load("oXMLBranch")}catch(e){}if(void 0!=b)""==b?c.removeAttribute(a):UI.A(c,a,b),c.save("oXMLBranch");else return UI.A(c,a)||""}else return"$No$"}catch(f){MI.Bos("btnStorageFull"),MI.S.clear()}};MI.S._body=UI.html('<input style="display:none;behavior:url(#default#userData)" id="usersData">')[0];MI.S.clear=function(){var a=/^draft|top|time|option|tips/,b=window.localStorage;if(b)try{for(var c in b)c.match(a)||(b[c]="")}catch(e){}else if(UI.B.ie){var f=MI.S._body;f.load("oXMLBranch");UI.each(f.xmlDocument.firstChild.attributes,function(b){try{var c=b.nodeName;c.match(a)||f.removeAttribute(c)}catch(e){}});f.save("oXMLBranch")}};MI.Pic=function(a,b){a.src="http://mat1.gtimg.com/www/mb/images/head_"+(b?b:50)+".jpg"};MI.videoThumb=function(a){a.src="http://mat1.gtimg.com/www/mb/images/vNoThumbs.jpg"};MI.Crs=function(a){clearTimeout(MI.delay.crs);var b=UI.scrollY(),c=b+1.5*UI.windowHeight(),e=b-100,f=0,g=0;MI.Crs.y&&(c+=MI.Crs.y);a&&(MI.crs=$$(".crs"));MI.Crs._body||UI.ready(function(){MI.Crs._body=UI.html('<div style="display:none"></div>')[0];UI.append(MI.Crs._body,document.body)});UI.each(MI.crs,function(a){if(!g&&UI.hasClass(a,"crs")){var b=UI.getY(a.parentNode)||UI.getY(a.parentNode.parentNode);if(b&&b<c&&b>e){var h=UI.A(a,"crs"),i,s=MI.Crs.iconPic&&h.hasString("mblogpic")&&!UI.hasClass(a,"noIconPic");setTimeout(function(){i=$$(a.parentNode,".preview")[0];if(s){var b=h.match(/\w{10,30}/g)||["NOMD5"];if(MI.Crs.iconPic.hasString(b[0])){h="http://mat1.gtimg.com/www/mb/images/vT.png";UI.addClass(a.parentNode.parentNode.parentNode,"iconPic")}else{i&&setTimeout(function(){UI.remove(i)},50);MI.Crs.iconPic=MI.Crs.iconPic+h}}if(i&&MI.user.fun.autoPic){var c=UI.A(i,"crs"),e=UI.DC("img");UI.append(e,MI.Crs._body);if(c){if(!s){UI.A(i,"src",c);UI.A(i,"crs","")}setTimeout(function(){UI.A(e,"src",c.replace(/[^\/]+$/g,"460"));MI.Bos("btnPicBigPreload")},500)}}if(UI.hasClass(a.parentNode,"vThumbs")){var f=a.parentNode.parentNode,b=$$(f,".vSimple")[0],f=$$(f,".vThumbs")[0];if(MI.Crs.iconPic.hasString(h)){UI.hide(f);UI.show(b)}else MI.Crs.iconPic=MI.Crs.iconPic+h}a.src=h;a.style.display="inline"},f);UI.removeClass(a,"crs")}b>c&&(g=1);f=f+20}});clearTimeout(MI.delay.resetCrs);MI.delay.resetCrs=setTimeout(function(){MI.crs=$$(".crs")},400)};MI.Crs.iconPic="x";MI.Code=function(){function a(){var c=b._value.value;!c||4>c.length||5<c.length?(b._value.focus(),b._msg.innerHTML="你输入的验证码有误，请重新输入"):c&&(MI.dialog.hide(),b.call&&setTimeout(function(){b.call(c)},300));return!1}var b=this;this._body=UI.html(MI.tmpl.code)[0];this._msg=$$(this._body,"h3")[0];this._code=$$(this._body,"img")[0];this._form=$$(this._body,"form")[0];this._codeChange=$$(this._body,".codeChange")[0];this._btn=$$(this._body,"button");this._value=$$(this._body,"input")[0];this._btn[0].onclick=a;this._btn[1].onclick=function(){MI.dialog.hide()};this._codeChange.onclick=function(){b._code.src=UI.A(b._code,"crs")+"&"+Math.random();b._value.focus();return!1};this._form.onsubmit=a};MI.Code.prototype={show:function(a){var b=this,c=MI.dialog,e,f;this._msg.innerHTML=a.msg;this._value.value="";this.call=a.call;this._code.src=a.code+"&"+Math.random();UI.A(this._code,"crs",a.code);c.display&&(e=c._cont.firstChild,f=c.width,b.end=function(){c.show({html:e,width:f,end:function(){b.end=null}})});c.show({html:this._body,width:a.width||363,end:b.end});setTimeout(function(){b._value.focus()},0)}};MI.Tips=function(){var a=this;a._body.onmouseover=function(){UI.show(a._body);clearTimeout(a.delay)};a._body.onmouseout=function(){clearTimeout(a.delay);a.delay=setTimeout(function(){a.hide()},150)}};MI.Tips.prototype={txt:"",delay:0,_body:UI.html('<div class="cmtTip"></div>')[0],build:function(a){var b=this,c=function(){clearTimeout(b.delay);var c=this;b.delay=setTimeout(function(){b.show(c,a.txt);UI.C(b._body,"width",a.width?a.width+"px":"")},150)},e=function(){clearTimeout(b.delay);b.delay=setTimeout(function(){b.hide()},150)};UI.each($$(a.area,a.target),function(b){b.tips||(b.onmouseover=c,b.onmouseout=e,a.click&&UI.EA(b,"click",function(){a.click.apply(b)}),b.tips=1)})},show:function(a,b){this.appended||(this.appended=1,UI.append(this._body,document.body));UI.isString(b)?(this._body.innerHTML=b,UI.show(this._body),this.position(a)):b.call(a,this._body)},position:function(a){var b=this._body,c=UI.getX(a),e=UI.getY(a),f=UI.height(a),g=UI.scrollY(),a=UI.scrollY(a)-g*(UI.B.safari&&!UI.B.ipad?2:1);b.style.cssText+=";top:"+(e+f-a+5)+"px;left:"+(c-20)+"px";c=UI.height(b);c+UI.getY(b)>g+UI.windowHeight()&&(b.style.top=e-c-5-a+"px")},hide:function(){UI.hide(this._body);this._body.style.left="-999px"}};MI.Tips.txt=['这条消息来自手机微博。<br>想要成为微博手机达人？点<a href="'+PATH+'/client.php?t=mobile" onclick="MI.Bos(\'btnPhoneIconTip\')" target="_blank" class="ulink">这里</a>'];MI.Tips.url={};MI.Load=function(a,b,c,e){function f(a,b){var c=$(a),e=c.parentNode,h=$$(e,"h3 .btn")[0];UI.hasClass(e,p);if(""==c.innerHTML||r)c.innerHTML=b;UI.removeClass(e,p);h.title=g;UI.evalScript(b);UI.removeClass(h,o)}var g="收起",o="loading",p="fold",r,t=MI.random();if(UI.isArray(a)&&a.length)UI.each(a,function(a){a=$(a).parentNode;$$(a,"h3 .btn")[0]||UI.DC("a")}),UI.get(b,"t="+c.join(",")+"&r="+t,function(b){b=MI.json(b);0==b.result&&(UI.each(a,function(a,e){var h=b.info[c[e]];h&&f(a,h)}),MI.Load.bottom());UI.each(a,function(a){a=$(a).parentNode;a=$$(a,"h3 .btn")[0];UI.removeClass(a,o)})});else{var s=$(a),q=s.parentNode,v=$$(q,"h3 .btn")[0]||UI.DC("a"),u=UI.hasClass(q,p);v.title=u?g:"展开";UI.A(s,"refresh")&&(r=1,MI.Bos("btnRefresh"+c));if(!UI.hasClass(v,o)&&(""==s.innerHTML||r?(r||UI.addClass(v,o),UI.get(b,"t="+c+"&r="+t,function(b){b=MI.json(b);if(b.result==0){f(a,b.info[c]);MI.Load.bottom()}UI.removeClass(v,o);UI.A(s,"refresh","")})):UI.toggleClass(q,p),MI.Load.bottom(),v.blur(),!r))MI.S("option_"+c+"_"+MI.user.account,u?1:-1),0!=e&&MI.Bos("btn"+(u?"Un":"")+"Fold"+c)}};MI.Load.bottom=function(){MI.talkList&&MI.talkList.bottom();$("pageNav")&&MI.bottom("pageNav");$("pageNavWrap")&&MI.bottom("pageNavWrap")};MI.PV=function(a){window.pvCurUrl&&""!=pvCurUrl&&(pvCurUrl="/"+a,pvRepeatCount=1,"function"==typeof pgvMain&&pgvMain())};MI.Host=function(){return top.window.location.host};MI.Bos=function(a,b){try{var c=MI.Uin(),e="",b=b||MI.boss;UI.isNumber(b)?e="&sServerIp=&iBackInt1="+b+"&iBackInt2=&sBackStr1=":UI.isString(b)&&(e="&sServerIp=&iBackInt1=&iBackInt2=&sBackStr1="+b);MI.Bos.pic.src="http://btrace.qq.com/collect?sIp=&iQQ="+c+"&sBiz=microblog&sOp="+a+"&iSta=0&iTy=302&iFlow=0"+e+"&Fsite="+MI.Host()+"&Ftype="}catch(f){}};MI.Uin=function(){var a=UI.trim(UI.cookie("luin")||UI.cookie("uin"));return Number(a.replace(/o/g,""))};MI.Bos.pic=new Image})();MI.TalkBox=function(a){if(this._body=UI.isString(a)?$(a):a){var b=this;b._txt=b.$("textarea")||b.$(".inputTxt");b._tip=b.$(".countTxt");b._guide=b.$("h2 em");b._tipBig=b.$(".talkSuc");b._btn=b.$(".sendBtn");b._topic=b.$(".creatNew");b._video=b.$(".uploadVideo");b._videoAnchor=$$(b._video,".txt")[0];b._music=b.$(".uploadMusic");b._musicAnchor=$$(b._music,".txt")[0];b._pic=b.$(".uploadPic");b._picForm=b.$(".picForm");b._picBtn=b.$(".picForm input");b._close=b.$(".close");b._num=[$("talkNum")];b._addReply=b.$(".addReply");b._addComt=b.$(".addComt");b._comts=b.$(".comts");b._guide&&(b.guide=b._guide.innerHTML);UI.ready(function(){function a(){clearTimeout(b.delay.guide);b.delay.guide=setTimeout(function(){if(b._guide){var a=b._txt.value,c=UI.trim(a).match(/^@[a-zA-Z]{1}[\w|-]{0,19}(?![\w-])/g),e,f=MI["follow_"+MI.user.account];if(c&&c[0].length!=a.length){c=c[0].slice(1);if(UI.A(b._guide,"user")!=c){f&&(e=f.info[c]);e?b._guide.innerHTML="对 "+e+" 说：":UI.get("/asyn/userCard.php","u="+c+"&r="+MI.random(),function(a){a=MI.json(a);a.result==0&&a.info.nick?b._guide.innerHTML="对 "+a.info.nick+" 说：":b.guideReset()});UI.A(b._guide,"user",c)}}else b.guideReset()}},200)}setTimeout(function(){b._txt.blur();b.countTxt()},0);var e=function(){if(!b.sending){b.countTxt();a()}},f=function(){clearTimeout(b.delay.count);b.delay.count=setTimeout(e,75)};UI.EA(b._txt,"keypress",f);UI.EA(b._txt,"input",f);UI.EA(b._txt,"paste",f);UI.EA(b._txt,"cut",f);b._txt.onbeforeeditfocus=f;b._body.onkeydown=function(a){if(!b.sending){a=UI.E(a);if(a.ctrl&&a.key==13){b.sending=1;f();b.send();MI.Bos("btnCtrlEnter")}else MI.Capture&&(MI.Capture.uploader&&a.key==86)&&MI.Capture.upload()}};b._body.onkeyup=function(){b.sending||f()};b._txt.onfocus=function(){UI.addClass(this,"focus");this.focused=1;a()};b._txt.onblur=function(){var a=this;clearTimeout(b.delay.blur);b.delay.blur=setTimeout(function(){UI.removeClass(a,"focus");b.sending||b.countTxt()},0);this.focused=0};UI.hasClass(b._txt,"noAutoCmt")||new MI.AutoCmt({target:b._txt,key:1,call:function(){f();MI.Bos("btnAutoAtAccount")}});if(b._topic)b._topic.onclick=function(){b.addTopic();MI.Bos("btnTopic");return false};if(b._addReply)b._addReply.onclick=function(){UI.hide(this);var a=b._txt.value.length;b._txt.value=b._txt.value.replace(this.txt,"");b.countTxt();b._txt.focus();MI.selectTxt(b._txt,a,a,a);MI.Bos("btnAddReply");return false};if(b._addComt)b._addComt.onclick=function(){b._txt.focus();return false};b._btn.onclick=function(){if(!UI.hasClass(this,"disabled")){b.countTxt();b.send();switch(b.type){case null:MI.Bos("btnSend","",0.01);break;case 1:MI.Bos("btnSendReply");break;case 2:MI.Bos("btnSendRelay");break;case 3:MI.Bos("btnSendMsg");break;case 4:MI.Bos("btnSendRelayList");break;case 5:MI.Bos("btnSendComt")}}};if(b._close)b._close.onclick=function(){UI.B.ie&&UI.C(b._close,"right","9999px");setTimeout(function(){b.hide();UI.C(b._close,"right","")},0);MI.Bos("btnClose");return false}})}};MI.TalkBox.prototype={delay:{},delayTime:1500,delayVideo:null,delayVideoTime:null,url:"/publish.php",type:null,source:0,countType:"",iconPic:0,pic:"",code:null,topic:null,talkId:null,txtMax:140,txtCache:"",txtTopic:"#输入话题标题#",txtPic:"#分享照片#",txtVideo:"",txtMusic:"#分享音乐#",txtTip:{empty:"请输入内容",fail:"发送失败",repeat:"内容重复"},txtTipSend:"广播中",addList:0,addCheck:null,addNum:1,autoHeight:0,tmpl:MI.tmpl.listAll,countUrl:1,msgTips:{m_0:"广播成功","m_-1":"未登录","m_-2":"未注册用户","m_-3":"系统错误","m_-4":"发表失败","m_-5":"连接超时","m_-6":"含敏感词","m_-7":"网络安全问题","m_-8":"参数错误","m_-9":"说话太快了","m_-10":"原文已删除","m_-11":"系统繁忙","m_-12":"说话太快了","m_-13":"内容重复了","m_-14":"话题数过多","m_-15":"操作被限制","m_-16":"请输入内容","m_-17":"原文审核中","m_-18":"再说点什么","m_-100":"验证码有误","m_-101":"验证码非法","m_-102":"请输验证码"},countTxt:function(){var a=this,b=a._txt.value,c,e,f;c=b.match(RegExp("((news|telnet|nttp|file|http|ftp|https)://){1}(([-A-Za-z0-9]+(\\.[-A-Za-z0-9]+)*(\\.[-A-Za-z]{2,5}))|([0-9]{1,3}(\\.[0-9]{1,3}){3}))(:[0-9]*)?(/[-A-Za-z0-9_\\$\\.\\+\\!\\*\\(\\),;:@&=\\?/~\\#\\%]*)*","gi"))||[];var g=0,h=0;a.length=e=MI.string.length(b);500>e&&(a.countUrl&&UI.each(c,function(a){b=b.replace(a,"_");h++;f=a.length;256<f&&(g+=f-256)}),a.length=e=Math.ceil((MI.string.length(UI.trim(b).replace(RegExp(a.txtTopic,"g"),""))+20*h+g)/2));if(e||!a._tip.innerHTML.hasString(a.txtTip.empty)){e>this.txtMax?(c='超出<em class="error">',a._btn.disable=1):(c="还剩<em>",a._btn.disable=0);0==e&&(a._btn.disable=1);a.showTip(c+Math.abs(a.txtMax-e)+"</em>字");if(a._msgTo&&(""==a._msgTo.value||a._msgTo.error))a._btn.disable=1;e<=a.txtMax&&1==a.type&&(a._btn.disable=0);a.autoHeight&&(clearTimeout(this.delay.height),this.delay.height=setTimeout(function(){UI.C(a._txt,"height","");var b=a._txt.scrollHeight;UI.B.ie&&(a.autoHeight>40&&b<38?b=37:a.autoHeight<=40&&b<=18&&(b=16));if(a.autoHeight>40&&b>=a.autoHeight)b=a.autoHeight;if(b>=136){b=136;UI.C(a._txt,"overflowY","auto")}else UI.C(a._txt,"overflowY","hidden");UI.C(a._txt,"height",b+"px");a._txt.nextSibling&&UI.C(a._txt.nextSibling,"height",b+"px")},UI.B.ipad?800:100));a.autoSave&&(e<=this.txtMax&&MI.isS)&&(clearTimeout(a.delay.save),a.delay.save=setTimeout(function(){a.save()},80))}},focus:function(){MI.focus(this._txt)},guideReset:function(){this._guide.innerHTML=this.guide;UI.A(this._guide,"user","")},save:function(){try{MI.S("draft_"+MI.user.account,this._txt.value.replace(RegExp(this.txtTopic,"g"),"")||"")}catch(a){}},showTip:function(a,b){2==b?UI.addClass(this._tip,"loading"):UI.removeClass(this._tip,"loading");this._tip.innerHTML=1==b?'<span class="error">'+a+"</span>":a},flashTip:function(){clearInterval(this.delay.flashTip);UI.C(this._tip,"opacity","0");this.delay.flashTip=UI.animate(this._tip,"opacity",1,0,0.1)},hide:function(){UI.remove(this._body);this.hideCall&&this.hideCall()},hideCall:null,success:null,send:function(){var a=this,b,c=1,e=UI.trim(a._txt.value.replace(RegExp(a.txtTopic,"g"),""));UI.hasClass(a._btn,"disabled")||(a._btn.disable||UI.hasClass(a._btn,"disabled")?(0==a.length&&a.showTip(a.txtTip.empty,1),a._txt.focus(),a._msgTo&&""==UI.trim(a._msgTo.value)&&a._msgTo.focus(),a.sending=0,a.flashTip()):(a._btn.disable=1,UI.addClass(a._btn,"disabled"),!a.type&&!a.pic&&!a.topic&&e.match(/^@[a-zA-Z]{1}[\w|-]{0,19}$/g))?document.location.href=PATH+"/"+e.slice(1)+"?from=1":(a.delay.tip=setTimeout(function(){a.showTip(a.txtTipSend,2)},500),b={content:e.replace(/＠/g,"@").replace(/＃/g,"#"),pic:a.pic,countType:a.countType,viewModel:a.iconPic},a.code&&(b.veriCode=a.code),a.type&&(b.pId=a.talkId,b.type=a.type),a._msgTo&&(b.account=a._msgTo.value.replace(/^@/,"")),a.topic&&(b.content=(b.content.match(RegExp(MI.string.escapeReg(a.topic)))?"":a.topic)+b.content),a.music&&a.music.id&&(b.musicID=a.music.id,b.musicSong=a.music.song,b.musicSinger=a.music.singer,b.musicLocation=a.music.songurl),a.video&&(b.video=a.video),a.addCheck&&!b.content.hasString(a.addCheck)&&(c=0),a.source&&(b.source=a.source),a.start&&a.start(),UI.ajax({url:a.url,data:b,success:function(b){clearTimeout(a.delay.timeout);b=MI.json(b);if(MI.user&&b.info&&UI.isObject(b.info)){var g=b.info.talk[0],h=MI.user;g.pic=h.pic;g.nick=g.nick||h.name;g.name=g.name||h.account;g.flag=g.flag&&UI.isArray(g.flag)?h.flag:g.flag;b.info.iconPic=a.iconPic;b.info.guest=0;b.info.fav=0}if(b.result==-100){MI.code.show({msg:b.msg,code:b.info,call:function(b){a.code=b;a.send()}});UI.removeClass(a._btn,"disabled");a._btn.disable=0;setTimeout(function(){a.countTxt()},500)}else{clearTimeout(a.delay.tip);a.showTip(a.msgTips["m_"+b.result]||"",b.result<0?1:0);a.flashTip();b.result==-1&&MI.alert('<div>请登录后再转播或评论微博</div><div><a href="http://t.qq.com'+(cfg.pref?"?pref="+cfg.pref:"")+'" target="_blank">点击登录&gt;&gt;</a></div>');b.result==-2&&MI.alert('<div>您还未开通腾讯微博</div><div><a href="http://t.qq.com/reg/index.php'+(cfg.pref?"?pref="+cfg.pref:"")+'" target="_blank">点击开通&gt;&gt;</a></div>');if(b.result==0&&a._tipBig){$$(a._tipBig,".msg")[0].innerHTML=b.msg;a.type!=4&&UI.addClass(a._body,"pubSuc");UI.show(a._tipBig)}a.delay.tip=setTimeout(function(){UI.animate(a._tip,"opacity",1,function(){if(b.result==0)a._txt.value="";try{a._txt.focus()}catch(c){}a.countTxt();if(a._msgTo&&b.result>-9&&b.result<-5)try{a._msgTo.select()}catch(e){}UI.C(a._tip,"opacity","");a._tip.style.filter="";a.sending=0;UI.removeClass(a._btn,"disabled");if(b.result==0){a.delPic();a.delVideo();a.delMusic();a.code=null;MI.Music&&MI.Music.builded&&MI.Music.clear();a._guide&&a.guideReset()}if(a.success&&b.result==0){a.success(b);UI.hide(a._tipBig)}})},b.result==0?a.delayTime:a.delayTime+1E3)}a.successStart&&b.result==0&&a.successStart();a.failStart&&b.result!=0&&a.failStart(b);if(MI.talkList&&a.addList&&b.result==0&&c){MI.talkList._tip&&UI.hide(MI.talkList._tip);MI.talkList.add.push(b.info.talk[0].id);var i=UI.html((new UI.tmplString(a.tmpl))(b.info))[0];MI.talkList.addEvent(i);UI.addClass(i,"newMsg");UI.prepend(i,MI.talkList._body);MI.talkList.card();MI.talkList.buildTips();MI.talkList._news.push(i);var k=UI.height(i);UI.scrollY();UI.C(i,"height",0);setTimeout(function(){UI.animate(i,"height",k-22,function(){UI.C(i,"height","");MI.talkList.bottom();MI.Crs(1)},0.3)},0)}g="draft_"+MI.user.account;a.autoSave&&MI.isS&&MI.S(g,"");if(b.result==0){a.type!=4&&a.countNum(1);MI.talkList&&MI.talkList.updateTime(b.info.talk[0].timestamp);a.txtCache=e;try{parent.wb_pbMsg&&parent.wb_pbMsg(0)}catch(j){}}try{parent.MB_PUBLISH_CALLBACK(b)}catch(n){}}}),a.delay.timeout=setTimeout(function(){a.showTip(a.txtTip.fail,1)},2E4)))},countNum:function(a){if((!(0<a)||this.addNum)&&this._num.length)for(var b=0,c=this._num.length;b<c;b++)MI.countNum(this._num[b],a)},addTopic:function(a){this._txt.focus();var b=a?"#"+a+"#":this.txtTopic;this._txt.value.hasString(b)||MI.insertTxt(this._txt,b,MI.cursorX(this._txt));a=this._txt.value;a=a.replace(/\r/g,"").indexOf(b);-1==a&&(a=0);MI.selectTxt(this._txt,a+1,a+b.length-1,a);this._txt.scrollTop=999;this.countTxt()},uploadPic:function(){UI.show(this._picLoading);UI.addClass(this._picLoading,"loading");UI.hide(this._picForm);UI.hide(this._picTxt);UI.hide(this._picIco)},addPic:function(a){UI.hide(this._picLoading);UI.hide(this._picTxt);UI.hide(this._picForm);UI.show(this._picIco);if(0==a.result){UI.removeClass(this._pic,"hover");this.pic=a.info.image;MI.user.fun.turnPic&&a.info.path&&MI.PicTurn.reset(this.pic,a.info.path);var b=a.info.fileName||this._picBtn.value,c=b.substring(b.lastIndexOf(".")+1,b.length),b=b.match(/[^\/|\\]*$/)[0].replace(c,""),b=MI.string.cut(b,10)+c;MI.user.fun.turnPic&&a.info.path?(this._picLink.innerHTML='<a href="#" class="fileName" onclick="return false">'+b+"</a>",$$(this._picLink,".fileName")[0].onmouseover=function(){MI.PicTurn.show()},$$(this._picLink,".fileName")[0].onmouseout=function(){MI.PicTurn.hideT()}):this._picLink.innerHTML='<a href="#" class="fileName" onclick="return false">'+b+'<img src="'+a.info.image+'/160" /></a>';UI.show(this._picPreview);""==this._txt.value&&(this._txt.value=this.txtPic,this.countTxt());this.focus()}else UI.show(this._picTxt),UI.show(this._picForm),alert(a.msg);this._picForm.reset()},delPic:function(){this._pic&&(this.pic="",this._picForm.reset(),UI.hide(this._picPreview),UI.hide(this._picLoading),UI.show(this._picIco),UI.show(this._picTxt),UI.show(this._picForm),this._txt.value==this.txtPic&&(this._txt.value=""),MI.Capture&&MI.Capture.uploader&&MI.Capture.uploader.StopUpload())},delVideo:function(){this._video&&(this.video="",UI.remove(this._videoPreview),UI.show(this._videoAnchor),this._txt.value==this.txtVideo&&(this._txt.value=""))},delMusic:function(){this._music&&(this.music="",UI.remove(this._musicPreview),UI.hide(this._musicBox),UI.show(this._musicAnchor),this._txt.value==this.txtMusic&&(this._txt.value=""))},cancelPic:function(){this._pic&&(this.pic="",UI.hide(this._picLoading),UI.show(this._picIco),UI.show(this._picForm),UI.show(this._picTxt),this._iframe.src="about:blank",this._picForm.reset())},$:function(a){return $$(this._body,a)[0]}};MI.PicTurn={pos:0,path:"",cache:[],build:function(a){var b=this;b.talkBox=a;b._body=UI.html("<div "+(UI.B.ie6?"":'class="big"')+' style="display:none;margin:3px 0 8px;padding:4px;border:1px solid #e5e5e5;background:#f9f9f9;position:absolute;z-index:20;top:15px;left:0px;"><div class="tools" style="width:130px"><a class="btnBack" href="#" style=""><em'+(UI.B.ie6?" style=\"width:17px;background:url('http://mat1.gtimg.com/www/mb/images/b2_100907.png') no-repeat scroll -162px -233px transparent;\"":"")+'></em>向左转</a><span>|</span><a class="btnPrev" href="#"><em'+(UI.B.ie6?" style=\"width:17px;background:url('http://mat1.gtimg.com/www/mb/images/b2_100907.png') no-repeat scroll -179px -233px transparent;\"":"")+'></em>向右转</a></div><div class="loading" style="width:112px;line-height:1.231;height:19px;_height:21px;display:none;">处理中...</div><div class="imgct" style="clear:both;text-align:center;"></div><form method="POST" target="imageRotate" action="/asyn/rotatepic.php"><input type="hidden" id="irRetType" name="retType" value="0" /><input type="hidden" id="irPath" name="path" /><input type="hidden" id="irDegrees" name="degrees" /></form><iframe id="imageRotate" name="imageRotate" src="about:blank" style="display:none"></iframe></div>')[0];b._imgCt=$$(b._body,".imgct")[0];b._picLoading=$$(b._body,".loading")[0];b._tools=$$(b._body,".tools")[0];b._form=$$(b._body,"form")[0];$$(b._body,".btnPrev")[0].onclick=function(){this.blur();b.turn(1);MI.Bos("btnPicTurn");return!1};$$(b._body,".btnBack")[0].onclick=function(){this.blur();b.turn(-1);MI.Bos("btnPicTurn");return!1};b._body.onmouseover=function(){clearTimeout(b.hl);b.show()};b._body.onmouseout=function(){b.hide()};return b._body},turn:function(a){this.pos+=a;3<this.pos?this.pos-=4:0>this.pos&&(this.pos+=4);(a=this.cache[this.pos])?(this.talkBox.pic=a,this.set(a)):this.get()},get:function(){UI.hide(this._tools);this._picLoading.style.display="block";UI.A(this._form,"action",MI.UploadServer.get()+"/asyn/rotatepic.php");$("irPath").value=this.path;$("irDegrees").value=90*this.pos;this._form.submit()},over:function(a){0==a.result&&(a=a.info.image,this.talkBox.pic=a,this.cache[this.pos]=a,this.set(a));UI.hide(this._picLoading);UI.show(this._tools)},set:function(a){this._imgCt.innerHTML='<img src="'+a+'/160" />'},show:function(){UI.show(this._body)},hide:function(){UI.hide(this._body)},hideT:function(){var a=this;a.hl=setTimeout(function(){a.hide()},200)},reset:function(a,b){this.pos=0;this.path=b;this.cache=[a];this.set(a);UI.hide(this._picLoading);UI.show(this._tools)}};MI.UploadServer={selected:void 0,all:[1,2,3,4,5],random:function(){this.selected=this.all.length?UI.random(0,this.all.length-1):void 0},get:function(){return"http://upload.t.qq.com"},error:function(){this.all.splice(this.selected,1);this.random()}};MI.DisableDblClickSelect=function(a){if(a){var b=function(){return(a.getAttribute("_MouseDownNoSelect_")||"").toString().split(",")};1==b().length&&(a.setAttribute("_MouseDownNoSelect_",[+new Date,"up"]),a.onmousedown=function(c){var e=+new Date,f=parseInt(b()[0]);a.setAttribute("_MouseDownNoSelect_",[e,"down"]);500>e-f&&UI.E(c).prevent()},a.onmouseup=function(){var c=b()[0];a.setAttribute("_MouseDownNoSelect_",[c,"up"])},a.onselectstart=function(a){"up"==b().pop()&&UI.E(a).prevent()})}return a};MI.TalkList=function(a){var b=this,c=$("moreList");b._body=UI.isString(a)?$(a):a;b._more=b._bottom=c?$$(c,"a")[0]:UI.DC("a");b._new=$("talkNew");b._list=UI.children(b._body);a=(new UI.tmplString(MI.tmpl.reply))({});b._talk=b._relay=UI.html(a)[0];b._relayList=UI.html('<div class="relayList"><div class="top"><span class="left"><a href="#" class="vClose"><em></em>收起</a></span><a class="w_close" href="#" title="点击关闭"><b class="close"></b></a></div><div class="loading">正在加载...</div><div class="cont"></div></div>')[0];b._relayListLoad=$$(b._relayList,".loading")[0];b._relayListCont=$$(b._relayList,".cont")[0];b._relay=UI.html(a)[0];b._comt=UI.html(MI.tmpl.reply.replace('<div class="left"></div>','<div class="left"><label for="replayListCheckbox"><input id="replayListCheckbox" type="checkbox" class="check1">同时转播</label></div>'))[0];b._confirm=UI.html('<div class="delChose"><span></span><br><input value="确定" type="button">&nbsp;&nbsp;<input value="取消" type="button"></div>')[0];b._confirmTip=$$(b._confirm,"span")[0];a=$$(b._confirm,"input");a[0].onclick=function(){try{var a=0,b=MI.TalkList.lastMusic;if(b)try{this.parentNode.tid==b.parentNode.parentNode.parentNode.id&&(a=1)}catch(c){}a&&MI.TalkList.musicClose()}catch(e){}MI.talkList.remove(this.parentNode.tid,this.parentNode.type)};a[1].onclick=function(){UI.removeClass(this.parentNode.parentNode.parentNode,"hover");UI.remove(b._confirm)};b.replyBox=new MI.TalkBox(b._talk);b.relayBox=new MI.TalkBox(b._relay);b.comtBox=new MI.TalkBox(b._comt);b.replyBox.autoHeight=136;b.relayBox.autoHeight=30;b.comtBox.autoHeight=136;b.replyBox.txtTipSend="发送中";b.relayBox.txtTipSend="转播中";b.comtBox.txtTipSend="评论中";b.replyBox._btn.title="发送";b.relayBox._btn.title="转播";b.comtBox._btn.title="评论";b.comtBox._btn.style.backgroundImage="url(http://mat1.gtimg.com/www/mb/images/b2_110809.png)";b.replyBox.hideCall=b.relayBox.hideCall=b.comtBox.hideCall=function(){UI.removeClass($(b.cur),"cur")};b.replyBox.start=b.relayBox.start=b.comtBox.start=function(){b.updateRelayNum();b.talkBox._txt.blur();b.focus()};b.replyBox.success=b.relayBox.success=b.comtBox.success=function(){b.talkBox.hide();b.talkBox.display=0;UI.removeClass($(b.cur),"hover");b._relayNum&&(MI.countNum(b._relayNum,1),b._relayNum.innerHTML=b._relayNum.innerHTML,UI.addClass(b._relayNum.parentNode,"zfNumShow"),b._relayNum=null)};b.relayBox._num=$$(b.relayBox._body,".number")[0];b.comtBox.url="/publish.php";b.comtBox._num=$$(b.comtBox._body,".number")[0];b.comtBox._relayCheck=$$(b.comtBox._body,".check1")[0];b.comtBox._relayCheck.onclick=function(){var a=this.checked;b.comtBox.type=a?1:5;b.comtBox.talkId=a?b.cur:b.curSource;b.comtBox._tip.innerHTML="";b.comtBox.countTxt();b.comtBox.addList=a?b.relayBox.addList:0};UI.B.ipad&&UI.EA(b.relayBox._txt,"focus",function(){setTimeout(function(){MI.selectTxt(b.relayBox._txt,0,0,0)},100)});UI.EA(b.replyBox._close,"click",function(){b.replyHide()});UI.EA(b.relayBox._close,"click",function(){b.replyHide()});UI.EA(b.comtBox._close,"click",function(){b.replyHide()});b.cacheLast();b.cacheFirst();b._more&&(b._more.onmouseover=MI.hideFocus,b._more.onclick=function(a){b.more();UI.E(a).prevent()});if(b._new){b._new.onclick=function(){b.newly();MI.Bos("btnkNew");return false};var e;UI.EA(window,"scroll",function(){clearTimeout(e);e=setTimeout(f,50)});var f=function(){var a=UI.scrollY()+UI.windowHeight();UI.each(b._news,function(b){UI.hasClass(b,"newMsg")&&UI.getY(b)+UI.height(b)+70<a&&UI.removeClass(b,"newMsg")})}}$$(b._relayList,".w_close")[0].onclick=function(){var a=this;UI.B.ie&&UI.C(a,"left","9999px");setTimeout(function(){b.relayListHide();UI.C(a,"left","")},0);MI.Bos("btnRelayListClose");return false};var g=b._relayListCont;$$(b._relayList,".left a")[0].onclick=function(){b.relayListHide();MI.Bos("btnRelayListUp");return false};g.ondblclick=function(){var a=0;UI.each($$(b._relayListCont,".pages a"),function(b){b.innerHTML.hasString("下一页")&&(a=b)});if(a)a.onclick();else{b.relayListPosition();b.relayListHide()}MI.S("tips_relayList_"+MI.user.account,-1)};UI.B.ie&&(g.onmousedown=function(){g.onselectstart=null},g.onmouseup=function(){g.onselectstart=function(){return false}});setTimeout(function(){b.bottom();for(var a=0,c=b._list.length;a<c;a++)b.addEvent(b._list[a]);MI.user.account&&b.card();b.buildTips();b._body.onmouseover=function(){b.focus=function(){};b._body.onmouseover=null}},0);MI.app({Music:null})};MI.TalkList.prototype={cur:null,curSource:null,_tip:null,_news:[],auto:0,iconPic:0,moreTimes:0,refresh:0,removeUrl:"/delete.php",favorUrl:"/asyn/favoritemsg.php",removeTip:"确定删除这条广播？",removeCall:0,unfavTip:"确定删除这条收藏？",xhr:{},last:{},first:{time:1},add:[],time:[],lastVideo:null,lastMusic:null,musicState:0,musicPlayDetec:0,musicDelay:0,card:function(){},buildTips:function(a){var b=this;setTimeout(function(){MI.tips.build({area:a||b._body,target:".ico_phone",txt:MI.Tips.txt[0]});MI.tips.build({area:a||b._body,target:".url,.ico_video",txt:b.urlTips,click:function(){MI.Bos("btnClickUrl")},width:220})},200)},urlTips:function(a){function b(b){if(0==b.result){var f=UI.A(c,"reltitle");f&&(b.info.title=f);h=b.info.url;b.info.title&&2<b.info.safe?(g=MI.string.cut(b.info.title,26),h=MI.string.cut(h,60),i="<br>"):(g=e[b.info.safe-1]||e[0],i="：",h=MI.string.cut(h,80));h=h.breakWord(0);UI.B.ie&&(h+=' <textarea style="display:none">'+b.info.url+'</textarea><a href="#" onclick="var a=window.clipboardData.setData(\'Text\',this.previousSibling.value),b=this.nextSibling;UI.hide(this);UI.show(b);b.innerHTML=a?\'复制成功\':\'复制失败\';return false">[复制]</a><span class="cNote" style="display:none"></span>');2<b.info.safe&&UI.A(c,"href",(UI.B.ie?" ":"")+b.info.url);a.innerHTML='<em class="ico safe_'+(b.info.safe||1)+'"></em><div class="safeType">'+MI.string.html(g)+i+h+"</div></div>";UI.show(a);MI.tips.position(c)}}if("A"==this.nodeName){var c=this,e=["原链接有风险","原链接不建议打开","腾讯网","原链接"],f=c.innerHTML.match(/[^\/]+$/g)[0],g="",h="",i="",k=+new Date;c.title&&(UI.A(c,"reltitle",c.title),c.title="");MI.Tips.url[f]?(b(MI.Tips.url[f]),MI.Bos("btnViewUrl")):UI.get("/asyn/urldetail.php","url="+f,function(a){a=MI.json(a);if(a.result==0){b(a);MI.Tips.url[f]=a;MI.Bos("btnViewUrl",+new Date-k)}})}},bosHead:function(){MI.Bos("btnHead")},focus:function(){if(!UI.hasClass(document.body,"ipad")){var a=$$($(this.cur),".time"),b=a.length;b&&(a=a[b-1],UI.B.ie&&(a.onfocusout=function(){"BODY"==document.activeElement.nodeName&&a.focus()}),a.focus())}},remove:function(a,b,c){var a=String(a),e=this,f=$(a),g=e.removeUrl,h={id:a,r:MI.random()},i;c&&(h.veriCode=c);b&&(g=e.favorUrl,h.op=2>b?1:2);e.mId&&(h.mId=e.mId);f.sending||(UI.ajax({url:g,data:h,success:function(c){f.sending=0;c=MI.json(c);if(c.result==0){i=$$(f,".fav")[0];if(b==1){UI.addClass(i,"light");i.title="取消收藏";i.type=3}else{UI.remove(e._confirm);MI.talkBox&&!b&&MI.talkBox.countNum(-1);if(b==3){UI.removeClass(i,"light");i.title="收藏";i.type=1}else{UI.addClass(f,"delMsg");setTimeout(function(){UI.animate(f,"opacity",0,function(){UI.remove(f);e.tip&&UI.children(e._body);e.bottom()})},300)}}e.removeCall&&e.removeCall()}else c.result==-100&&MI.code.show({msg:c.msg,code:c.info,call:function(c){e.remove(a,b,c)}})}}),f.sending=1)},fav:function(a,b){this.remove(a,b)},confirm:function(a,b){var a=String(a),c=this,e=$(a),f=$$(e,".msgBox")[0],g=b?c.unfavTip:c.removeTip;UI.append(c._confirm,f);c.relayListHide();setTimeout(function(){$$(c._confirm,"input")[0].focus()},0);c._confirm.tid=e.id;c._confirm.type=b;c._confirmTip.innerHTML=g;c.talkBox&&(c.talkBox.display&&c.cur==e.id)&&(UI.remove(c.talkBox._body),UI.removeClass(e,"cur"),c.talkBox.display=0)},reply:function(a,b){var c=this;MI.card&&UI.remove(MI.card._body);c.relayListHide();c.talkBox&&c.talkBox.hide();c.talkBox&&(c.cur&&c.cur!=a&&c.talkBox.display)&&(c.talkBox.display=0);c.talkBox=2==b?c.comtBox:b?c.relayBox:c.replyBox;c._talk=c.talkBox._body;c.talkBox.iconPic=c.iconPic;UI.C(c.talkBox._txt,"height","");UI.removeClass(c.talkBox._btn,"disabled");UI.removeClass(c._talk,"pubSuc");if(c.talkBox.display)this.talkBox.hide(),this.replyHide();else{MI.open.stop();var e=$(a),f=c.cur,g=$$(e,".zfNum")[0],h=$$(e,".userName strong a")[0].innerHTML,i;$$(e,".userName .vip");$$(e,".userName .ico_expo");var k=UI.A($$(e,".userName")[0],"rel"),j=$$(e,".msgCnt")[0].cloneNode(1),n,m=$$(e,".replyBox")[0];n=$$(e,".replyBox .msgCnt")[0];$$(e,".userPic");var o,p=c.talkBox._txt;g&&g.href.match(/[^\/]+$/g);b&&UI.each($$(j,"em"),function(a){var b=UI.A(a,"rel");if(b)a.innerHTML=b});g=UI.text(j);n&&(n=UI.text(n).split(":"),b&&(i=h,h=n[0]),n=n.slice(1).join(":"));f&&UI.removeClass($(f),"cur");UI.addClass(e,"cur");this._relayNum=b?$$(e,".relayNum")[0]:null;var r;$$(this._talk,".replyTitle")[0].innerHTML=2==b?"评论原文":b?"转播原文，转播内容会发送给你的听众<br>顺便说两句:":"对 <b>"+h+"</b> 说:";this.talkBox._body.className=2==b?"talkWrap comtWrap":b?"zfWrap":"talkWrap";m&&i&&1==b?(this.talkBox._addReply.innerHTML='<a href="#" title="你可以通过“删除之前的转播理由”来去掉前面人的转播理由">［删除之前的转播理由］</a>',o=this.talkBox._addReply.txt=" || @"+k+": "+UI.trim(g),UI.show(this.talkBox._addReply),UI.B.ipad||(p.onkeyup=function(){clearTimeout(r);r=setTimeout(function(){if(!p.value.hasString(o)){UI.hide(c.talkBox._addReply);p.onkeyup=null}},400)})):(UI.hide(this.talkBox._addReply),p.onkeyup=null);c.talkBox.talkId=a;c.talkBox.type=b?1:2;!c.comtBox._relayCheck.checked&&2==b&&(c.talkBox.talkId=c.curSource,c.talkBox.type=5);this.talkBox._txt.value="";this.talkBox.countTxt();UI.append(this._talk,$$(e,".msgBox")[0]);setTimeout(function(){p.focus();if(o)p.value=p.value+o;c.talkBox.countTxt();MI.selectTxt(p,0,0,0)},0);this.cur=a;this.talkBox.display=1}UI.each([this.replyBox,this.relayBox,this.comtBox],function(a,c){if(b!=c){a.hide();a.display=0}});if(this.replyBox.display||this.relayBox.display||this.comtBox.display)UI.addClass($(this.cur),"cur"),UI.addClass($(this.cur),"hover");c.setArrow($$(this.talkBox._body,".SA")[0])},replyHide:function(){MI.open.start();UI.removeClass($(this.cur),"cur");UI.removeClass($(this.cur),"hover");this.talkBox&&(this.talkBox.display=0)},relayListHide:function(){this._relayList.display&&(UI.remove(this._relayList),this._relayList.display=0,UI.removeClass($(this.cur),"cur"),UI.removeClass($(this.cur),"hover"),this.focus())},getRelayOld:function(a,b,c){var c=$$(b,c)[0],e=$$(b,"strong a")[0].href.split("/"),e=e[e.length-1],f;c&&1==$$(b,".time").length&&(f=1);b=c.cloneNode(1);f||(UI.each($$(b,"em"),function(a){var b=UI.A(a,"rel");b&&(a.innerHTML=b)}),a._txt.value=" || @"+e+": "+UI.text(b));a._txt.focus();MI.selectTxt(a._txt,0,0,0);a.countTxt()},updateRelayNum:function(){var a=$(this.cur),b=this.talkBox.type,c;4==b||5==b?c=".comt":1==b&&(c=".relay");c&&a&&(a=$$(a,c)[0],UI.A(a,"num",1+parseInt(UI.A(a,"num"))))},report:function(a){var b=UI.A($$($(a),".userName")[0],"rel");jubao_msg(a,b)},setArrow:function(a){a.style.cssText="left:"+(this.setArrow.x+3)+"px"},setArrowX:function(a,b){b=2==b.length?b[1]:b[0];this.setArrow.x=UI.getX(a)-UI.getX(b)-UI.width(a)/2},addEvent:function(a){function b(){"A"==this.nodeName&&MI.Bos("btnTime")}var c=this,e=$$(a,".time"),f=$$(a,".view")[0],g=$$(a,".fav")[0],h=$$(a,".light.fav")[0],i=$$(a,".alarm")[0],k=$$(a,".talkDetail")[0],j=$$(a,".zfNum"),j=j[j.length-1],n=$$(a,".msgCnt")[0],m=$$(a,".comt")[0],o=$$(a,".reply")[0],p=$$(a,".relay")[0],r=$$(a,".delBtn")[0],t=$$(a,".replyMsg")[0];$$(a,".picBox");var s=$$(a,".videoBox");$$(a,".musicBox");!UI.B.ipad&&"LI"==a.nodeName&&MI.addHover(a);MI.jumpEvent($$(a,"a"));m&&(m.onclick=function(){c.curSource=UI.A(this,"rel");c.setArrowX(this,e);c.comtBox._relayCheck.checked=!1;c.comtBox._relayCheck.onclick();c.reply(a.id,2,UI.A(this,"num"));MI.Bos("btnComt");return!1});o&&(o.onclick=function(){c.setArrowX(this,e);c.reply(a.id,0);MI.Bos("btnReply");return false});p&&(p.onclick=function(){c.setArrowX(this,e);c.reply(a.id,1,UI.A(this,"num"));MI.Bos("btnRelay");return false});f&&(f.onmouseover=f.ontouchstart=function(){UI.C(k,"display","block");MI.Bos("btnViewReply")},f.onmouseout=f.ontouchend=function(){UI.hide(k)},f.style.cursor="pointer",UI.A(f,"target","_blank"));j&&j.innerHTML.hasString("对话");g&&(g.type=1,g.title=(UI.hasClass(g,"light")?"取消":"")+"收藏",g.onclick=function(){c.fav(a.id,this.type);MI.Bos("btnFav");return false},g.onmouseover=MI.hideFocus);h&&(h.onclick=function(){c.confirm(a.id,2);MI.Bos("btnUnFav");return false},h.onmouseover=MI.hideFocus);r&&(r.onclick=function(){c.confirm(a.id);MI.Bos("btnDel");return false});n&&""==n.innerHTML&&(n.innerHTML="&nbsp;");i&&(i.onclick=function(){c.report(a.id);MI.Bos("btnReport");return false});t&&(t.onclick=function(){MI.talkBox._msgTo.value=UI.A(this,"rel");UI.removeClass(MI.talkBox._btn,"disabled");MI.talkBox._txt.value="";MI.talkBox.countTxt();if(MI.dialog){MI.dialog.show({width:560,html:$("talkBoxMsg")});try{setTimeout("MI.talkBox._txt.focus()",0)}catch(a){}}MI.Bos("btnReplyMsg");return false});s&&MI.TalkList.videoEvent(s);f=0;for(g=e.length;f<g;f++)UI.A(e[f],"rel")||UI.A(e[f],"rel",UI.A(a,"rel")),h=new Date,h.setTime(UI.A(e[f],"rel")+"000"),e[f].title=UI.formatDate(h,"yyyy年M月d日 hh:mm"),c.time.push(e[f]),e[f].onclick=b},cacheLast:function(){var a=UI.children(this._body),a=a[a.length-1],b;a&&(b=UI.A(a,"fav"),this.last={id:a.id,time:UI.A(a,"rel"),fav:b?b:0})},cacheFirst:function(){var a=UI.children(this._body)[0];a&&(this.first={time:UI.A(a,"rel"),id:a.id})},bottom:function(){var a=UI.parents(this._body,"main")[0],b,c,e;a&&this._more.innerHTML&&(b=UI.next(a),c=a.parentNode,e,b&&(UI.C(this._body,"marginBottom",0),e=UI.height(a)-UI.height(c)-1,UI.C(this._body,"marginBottom",0>e?-e+"px":"")))},updateTime:function(a){a=Number(a);if(!MI.time||60<a-MI.time)MI.time=a,UI.each(this.time,function(a){var c;c=MI.time;var e=new Date,f=UI.A(a,"rel"),g=UI.zoneDate(f+"000",8),h=c-f,f=parseInt(h/60);parseInt(h/3600);var h=parseInt(h/86400),i=a.title.split(" ")[1];e.setTime(c+"000");if(c=0>=f?"刚刚":60>f?1<f?f+'分钟前<i class="l"></i>':f+"分钟前":59<f&&0==h?(e.getDate()==g.getDate()?"今天":"昨天")+" "+i:1==h&&2>e.getDate()-g.getDate()?"昨天 "+i:e.getFullYear()==g.getFullYear()?a.title.split("年")[1]:a.title)a.innerHTML=c})},more:function(a){var b=this;UI.children(b._body);var c="r="+MI.random()+"&time="+(b.last.fav?b.last.fav:b.last.time)+"&id="+b.last.id+(b.guest?"&u="+b.guest:""),e=UI.A(b._more,"rel");b._more.sending||(UI.addClass(b._more,"loading"),e&&(UI.get(e,c,function(a){b.addMore(a)}),MI.Bos(a?"btnMoreAuto":"btnMore")));b._more.sending=1},newly:function(){var a=this,b=a._new;b.sending||(15<b.num||a.refresh?document.location.href="/"+MI.user.account:(UI.addClass(b,"loading"),UI.get("/asyn/home.php",{time:a.first.time,p:2,type:1,r:MI.random()},function(b){a.addNewly(b)})));b.sending=1},addNewly:function(a){var b=this._new,c=UI.isString(a);data=c?MI.json(a):a;if(0==data.result){data.info.guest=this.guest;data.info.fav=0;data.info.iconPic=this.iconPic;UI.each(this.add,function(a){$(a)&&UI.remove($(a))});var e,f=document.createDocumentFragment();e=UI.html((new UI.tmplString(MI.tmpl.listAll))(data.info).replace(/<li id="/gi,c?'<li class="newMsg" id="':'<li id="'));var g=data.info.talk.length;if(g){this._newLine&&UI.removeClass(this._newLine,"pageLine");for(var h=0,i=e.length;h<i;h++)this.addEvent(e[h]),UI.append(e[h],f),h==i-1&&(this._newLine=e[h],UI.addClass(e[h],"pageLine"));50<g&&(this._body.innerHTML="");e=this._news;h=0;for(i=e.length;h<i;h++)UI.removeClass(e[h],"newMsg");UI.prepend(f,this._body);this._news=$$(this._body,".newMsg");this.card();this.buildTips();UI.each(this.add,function(a){$(a)&&UI.removeClass($(a),"newMsg")});this.cacheFirst();this.add=[];this._tip&&UI.hide(this._tip);this.updateTime(data.info.time);MI.PV("new");MI.Crs(1);c&&(MI.ajax++,MI.talkNew.push(a))}}UI.hide(b);document.titleTmp&&(document.title=document.titleTmp);this.bottom();UI.removeClass(b,"loading");b.sending=0},addMore:function(a){var b=this,c=UI.isString(a),e=UI.children(b._body),e=e[e.length-1];data=c?MI.json(a):a;if(0==data.result){data.info.guest=b.guest;data.info.fav=b.last.fav?1:0;data.info.iconPic=b.iconPic;var f=document.createDocumentFragment(),g=UI.html((new UI.tmplString(MI.tmpl.listAll))(data.info));if(data.info.talk.length){for(var h=0,i=g.length;h<i;h++)UI.append(g[h],f);setTimeout(function(){for(var a=0,c=g.length;a<c;a++)b.addEvent(g[a]);b.card();b.buildTips();MI.Crs(1)},0);UI.append(f,b._body);UI.C(b._body,"marginBottom","");UI.B.ie||MI.GoTop.position();MI.dialog&&MI.dialog.display&&MI.dialog.resizeBg();MI.PV("more");c&&(MI.ajax++,MI.talkMore.push(a))}0==data.info.hasNext||!data.info.talk.length?(UI.addClass(b._more.parentNode,"hide"),b.more=function(){}):(e&&UI.addClass(e,"pageLine"),b.cacheLast());b.updateTime(data.info.time);b.moreTimes++}UI.removeClass(b._more,"loading");b._more.sending=0},newlyWall:function(){var a=this;UI.get("/asyn/wall.php","id=&r="+MI.random(),function(b){a.addNewlyWall(b)})},addNewlyWall:function(a){var b=this;data=UI.isString(a)?MI.json(a):a;if(0==data.result&&0<data.info.talk.length){data.info.guest=b.guest;data.info.fav=0;data.info.iconPic=b.iconPic;var c=$$(b._body,"li");if(0<c.length)for(var a=0,e=c.length;a<e;a++)if(c[a].id==data.info.talk[0].id&&0<a){UI.remove(c[a]);break}else if(c[a].id==data.info.talk[0].id&&0==a)return;var c=null,f=UI.html((new UI.tmplString(MI.tmpl.listAll))(data.info))[0];b.addEvent(f);UI.prepend(f,b._body);b.updateTime(data.info.time);b.buildTips();a=UI.height(f);UI.scrollY();UI.C(f,"height",0);UI.animate(f,"height",a-22,function(){UI.C(f,"height","");MI.Crs(1)},0.3)}setTimeout(function(){c=$$(b._body,"li");if(5<c.length)for(var a=5,e=c.length;a<e;a++)UI.remove(c[a])},2E3)}};MI.TalkList.videoEvent=function(a){for(var b=0,c=a.length;b<c;b++){var e=a[b],f=$$(e,".vWrap")[0],f=Number(f.getAttribute("thumbs")),e=$$(e,".vThumbsBox")[0],g=$$(e,".vSimple")[0],h=$$(e,".vThumbs")[0],i=$$(e,"span")[1];f?(h.style.display="inline",g.style.display="none"):g.style.display="inline";if(f){var k=$$(h,"img")[0];k.onload=function(){this.load=1;i.style.display="inline"};k.onerror=function(){MI.videoThumb(this)};setTimeout(function(){if(k.load)i.style.display="inline"},1500)}}};MI.MsgBox=function(a){function b(){c.countTxt()}var c=new MI.TalkBox(a);c.txtTipSend="发送中";c._msgTo=c.$(".msgTo");c._num=$$(".msgNum");c.type=3;c.url="/messages/send.php";(!UI.B.ie6||!UI.hasClass(c._txt,"noAutoCmt"))&&new MI.AutoCmt({target:c._msgTo,type:2,call:function(){c.countTxt();MI.Bos("btnAutoAtAccount")}});UI.EA(c._msgTo,"keyup",b);UI.EA(c._msgTo,"keydown",b);UI.EA(c._msgTo,"blur",b);return c};MI.MsgList=function(a){a=new MI.TalkList(a);a.removeTip="确定删除这条私信？";return a};MI.Talk=function(a){var b=this,c=(new UI.tmplString(MI.tmpl.reply))({});b.id=a;b._body=$(a);b._talk=UI.html(c)[0];b._relay=UI.html(c.replace(/<\/textarea>/g,"").replace(/textarea/g,"input"))[0];b._relayNum=$("relay"+a);b.replyBox=new MI.TalkBox(b._talk);b.relayBox=new MI.TalkBox(b._relay);b.replyBox.success=function(){MI.dialog.hide()};b.relayBox.success=function(){MI.dialog.hide();b._relayNum&&MI.countNum(b._relayNum,1)};b.replyBox.talkId=this.relayBox.talkId=a;b.reply=function(a){b.talkBox=a?b.relayBox:b.replyBox;UI.removeClass(b.talkBox._body,"pubSuc");var c="转播 <b>"+UI.trim(b.name)+'</b>: "'+MI.string.html(b.content.slice(0,25)),e="对 <b>"+b.name+"</b> 说:";25<b.content.length&&(c+="...");c+='"<br/>再说两句:';$$(b.talkBox._body,".replyTitle")[0].innerHTML=a?c:e;b.talkBox._body.className=a?"zfWrap":"talkWrap";b.talkBox.type=a?1:2;b.talkBox._txt.value="";b.talkBox.countTxt();MI.dialog.show({width:500,html:b.talkBox._body});setTimeout(function(){b.talkBox._txt.focus()},0)};a=$$(b._body,"a")[1];b.name=UI.text(a);b.account=UI.A(a,"rel");b.content=UI.text($$(b._body,".msgCnt")[0]);var a=$$(b._body,".alarm")[0],c=$$(b._body,".reply")[0],e=$$(b._body,".relay"),f=e[0],e=e[1],g=$$(b._body,".fav")[0],h=$$(b._body,".picBox");c&&(c.onclick=function(){b.reply();return!1});f&&(f.onclick=function(){b.reply(1);return false});e&&(e.onclick=function(){b.reply(1);return false});a&&(a.onclick=function(){jubao_msg(b.id,b.account);return false});g&&(g.type=1,g.onclick=function(){b.fav(b._body.id,this.type);MI.Bos("btnFav");return false});h&&MI.TalkList.picEvent(h)};MI.Talk.prototype=MI.TalkList.prototype;MI.FollowBtn={boss:null,followCall:null,unFollowCall:null,build:function(a,b,c){var e=this,f=$$(a||$$(".comList")[0],b||".pic a"),g=[];UI.each(f,function(a){if(!UI.hasClass(a,"cusPic")&&(g.push(MI.string.id(a.href)),!$$(a.parentNode,".attentBoxWrap").length)){var b=a;UI.hasClass(a,"masPic")&&(b=UI.next(a));UI.after(UI.html('<div class="attentBoxWrap '+(c?"":"attentBox")+'"></div>')[0],b)}});UI.get("/asyn/userRelation.php","r="+MI.random()+"&u="+g.join(","),function(b){b=MI.json(b);if(0==b.result){var g,k;UI.each(f,function(a){var e=MI.string.id(a.href),f;UI.hasClass(a,"cusPic")||(f=c?'<a class="foFun addAttention" href="#">+收听</a>':'<input type="button" class="addAttention" value="立即收听" />',b.info[e]&&(k=a.parentNode,g=$$(k,".attentBoxWrap")[0],e==MI.user.account&&(f=""),g.innerHTML=f,b.info[e][0]&&UI.hide(g.firstChild)))});e.addEvent(a,c)}});return!1},addEvent:function(a,b){var c=this,e="btnHeadFollow",f="btnHeadUnFollow";c.boss&&(e=c.boss[0],f=c.boss[1]);UI.each($$(a||document.body,".addAttention"),function(g){var h=UI.html(b?'<div class="foFun disabled" style="display:none">已收听</div>':'<a href="#" class="delAttention" style="display:none">取消</a>')[0];UI.after(h,g);g.style.display=="none"&&UI.show(h);g.onclick=function(){var f=this;MI.follow(c.user(f),f,function(){UI.hide(f);f.className="addAttention";UI.show(f.nextSibling)});a||MI.Bos(e+(b||""));c.followCall&&c.followCall();return false};if(!b)h.onclick=function(){var e=this;MI.follow(c.user(e),e,function(){UI.hide(e);e.className="delAttention";UI.show(e.previousSibling)});a||MI.Bos(f+(b||""));c.unFollowCall&&c.unFollowCall();return false}})},user:function(a){var b=UI.parents(a,"userList")[0];return MI.string.id((b?$$(b,".userInfo a")[0]:a.parentNode.previousSibling).href)}};MI.Reply=function(){var a;UI.hide(this._body);this.talkBox=new MI.TalkBox(this._body);this._talkTo=$$(this._body,".replyTitle")[0];this._msg=$$(this._body,".msg")[0];a=this.talkBox;a.txtTipSend="发送中";UI.addClass(a._txt,"noAutoComplete");a.successStart=function(){MI.dialog.showTip({html:"发送成功!"})};a.success=function(){UI.removeClass(a._body,"pubSuc")}};MI.Reply.prototype={_body:UI.html(MI.tmpl.reply)[0],show:function(){var a=this.talkBox;MI.dialog.show({html:this._body,width:500});this._talkTo.innerHTML="对 <b>"+a.talkTo+"</b> 说:";a._txt.value="";setTimeout(function(){a._txt.focus();a.countTxt()},0)}};MI.Msg=function(){var a;UI.hide(this._body);a=this.talkBox=new MI.MsgBox(this._body);a.successStart=function(){MI.dialog.showTip({html:"发送成功!"})};a.success=function(){UI.removeClass(a._body,"pubSuc")}};MI.Msg.prototype={_body:UI.html(MI.tmpl.msgBox)[0],show:function(){var a=this.talkBox;MI.dialog.show({width:570,html:this._body,start:function(){a._txt.value="";UI.removeClass(a._btn,"disabled")}});setTimeout(function(){a._txt.focus();a.countTxt()},0)}};MI.Open=function(a){a&&a.info.talk.length&&(this.data=a,this.length=a.info.talk.length,this.data.info.time=this.length?this.data.info.talk[0].timestamp:0,this.num=a.info.talk.length-1,this.freq=1E3*(!config.freq||1>config.freq?5:config.freq),this.initNum=!config.initNum||1>config.initNum?5:config.initNum,this.pickNum=!config.pickNum||1>config.pickNum?20:config.pickNum,this.init())};MI.Open.prototype={delay:null,init:function(){this.html=UI.html((new UI.tmplString(MI.tmpl.listAll))(this.data.info));this.addNew(this.initNum);this.start()},start:function(){var a=this;a.delay=setInterval(function(){a.addNew(1)},a.freq)},stop:function(){this.delay&&clearInterval(this.delay)},addNew:function(a){var b=this;if(0>b.num||a>=b.length)b.stop();else{for(var c=document.createDocumentFragment(),e=b.num,f=b.num-a;e>f;e--)UI.prepend(b.html[e],c);setTimeout(function(){for(var c=b.num,e=b.num-a;c>e;c--)MI.talkList.addEvent(b.html[c]);MI.talkList.updateTime(b.data.info.time);b.num-=a;MI.Crs(1)},0);UI.prepend(c,MI.talkList._body);if(1==a){var g=$$(MI.talkList._body,"li")[0],c=UI.height(g);UI.scrollY();UI.C(g,"height",0);UI.animate(g,"height",c-22,function(){UI.C(g,"height","")},0.3)}}}};UI.EA(window,"unload",function(){MI.talkBox&&MI.talkBox.autoSave&&MI.talkBox.save();try{for(var a in MI){if(UI.isObject(MI[a])&&!UI.isElement(MI[a]))for(var b in MI[a]){if(UI.isObject(MI[a][b])&&!UI.isElement(MI[a][b])){for(var c in MI[a][b])MI[a][b][c]=null;MI[a][b]=null}MI[a][b]=null}MI[a]=null}}catch(e){}});/*version:102483*//*  |xGv00|bb952cb3fea0cc6d1ef7b6e10a45f274 */